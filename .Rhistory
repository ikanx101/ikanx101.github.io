)
library(tidygraph)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101.github.io/_posts/bukan nfi/feedback")
library(dplyr)
library(ggplot2)
library(igraph)
library(ggraph)
library(tidygraph)
data = data.frame(
from = c(rep("Anthony",4),rep("Asih",2),rep("Kristi",4),
rep("Dian",7),rep("Elizabeth",2),"Endy",rep("Herman",5),
rep("Irene",6),
rep("Prima",4),
rep("Novitalia",4),
rep("Nina",3),
rep("Rani",5),
rep("Remon",4),
rep("Scasia",3),
rep("Sony",2),
rep("Steffira",5),
rep("Theresia",3),
rep("Veronica",8),
rep("Yola",5)),
to = c("Nanda","Ade","Remon","Bembi",
"Riangga","Remon",
"Laksmi","Nina","Willy","Dian",
"Theresia","Scasia","Sony","Nina","Epin","Endy","Steffira",
"Reza","Asih",
"Herman",
"Endy","Steffira","Theresia","Novitalia","Irene",
"Steffira","Prima","Novitalia","Rani","Yola","Evelyn",
"Evelyn","Fahmi","Riangga","Asih",
"Nina","Herman","Rani","Steffira",
"Rocky","Dian","Erika",
"Irene","Novitalia","Endy","Nina","Yola",
"Anthony","Laksmi","Elizabeth","Willy",
"Dian","Sony","Indra",
"Dian","Theresia",
"Irene","Novitalia","Rani","Arninta","Prima",
"Dian","Sony","Ellyana",
"Elizabeth","Irene","Anthony","Herman","Kristi","Asih","Remon","Dian",
"Irene","Rani","Prima","Ian","Herman")
)
graf = graph_from_edgelist(data)
graf = graph_from_data_frame(data)
graf
graf = graph_from_data_frame(data, mode = "directed")
graf = graph_from_data_frame(data, mode = "direct")
graf = graph_from_data_frame(data)
graf
tbl_graph = as_tbl_graph(graf)
tbl_graph
hub_id = which.max(degree(graf))
hub_id
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(
x = x,
y = y,
hub_dist = replace_na(bfs_dist(root = hub_id), Inf),
degree = degree(graph),
friends_of_friends = replace_na(local_ave_degree(), 0),
cluster = as.factor(group_infomap())
)
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(
x = from,
y = to,
hub_dist = replace_na(bfs_dist(root = hub_id), Inf),
degree = degree(graph),
friends_of_friends = replace_na(local_ave_degree(), 0),
cluster = as.factor(group_infomap())
)
View(tbl_graph)
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(
hub_dist = replace_na(bfs_dist(root = hub_id), Inf),
degree = degree(graph),
friends_of_friends = replace_na(local_ave_degree(), 0),
cluster = as.factor(group_infomap())
)
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(
hub_dist = tidyr::replace_na(bfs_dist(root = hub_id), Inf),
degree = degree(graph),
friends_of_friends = replace_na(local_ave_degree(), 0),
cluster = as.factor(group_infomap())
)
degree(graf)
tbl_graph
tbl_graph %>%
activate(nodes)
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(
x = from,
y = to,
hub_dist = tidyr::replace_na(bfs_dist(root = hub_id), Inf),
degree = degree(graph),
friends_of_friends = replace_na(local_ave_degree(), 0),
cluster = as.factor(group_infomap())
)
ggraph(graf)
ggraph(graf) +
geom_edge_arc() +
geom_node_point()
ggraph(graf) +
geom_edge_link() +
geom_node_point()
ggraph(graf,layout = "fr") +
geom_edge_link() +
geom_node_point()
View(tbl_graph)
plot(tbl_graph)
ggraph(tbl_graph,layout = "fr") +
geom_edge_link() +
geom_node_point()
hub_id
tbl_graph %>%
activate(nodes)
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf))
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap()))
tbl_graph
View(tbl_graph)
ggraph(tbl_graph,layout = "fr") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree))
ggraph(tbl_graph,layout = "fr") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name))
ggraph(tbl_graph,layout = "fr") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name)) +
coord_fixed() +
facet_nodes(~cluster)
ggraph(tbl_graph,layout = "kk") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name)) +
coord_fixed()
ggraph(tbl_graph,layout = "star") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name)) +
coord_fixed()
ggraph(tbl_graph,layout = "gem") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name)) +
coord_fixed()
degree(graf)
betweenness(graf)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101.github.io/_posts/bukan nfi/feedback")
library(dplyr)
library(ggplot2)
library(igraph)
library(ggraph)
library(tidygraph)
data = data.frame(
from = c(rep("Anthony",4),rep("Asih",2),rep("Kristi",4),
rep("Dian",7),rep("Elizabeth",2),"Endy",rep("Herman",5),
rep("Irene",6),
rep("Prima",4),
rep("Novitalia",4),
rep("Nina",3),
rep("Rani",5),
rep("Remon",4),
rep("Scasia",3),
rep("Sony",2),
rep("Steffira",5),
rep("Theresia",3),
rep("Veronica",8),
rep("Yola",5)),
to = c("Nanda","Ade","Remon","Bembi",
"Riangga","Remon",
"Laksmi","Nina","Willy","Dian",
"Theresia","Scasia","Sony","Nina","Epin","Endy","Steffira",
"Reza","Asih",
"Herman",
"Endy","Steffira","Theresia","Novitalia","Irene",
"Steffira","Prima","Novitalia","Rani","Yola","Evelyn",
"Evelyn","Fahmi","Riangga","Asih",
"Nina","Herman","Rani","Steffira",
"Rocky","Dian","Erika",
"Irene","Novitalia","Endy","Nina","Yola",
"Anthony","Laksmi","Elizabeth","Willy",
"Dian","Sony","Indra",
"Dian","Theresia",
"Irene","Novitalia","Rani","Arninta","Prima",
"Dian","Sony","Ellyana",
"Elizabeth","Irene","Anthony","Herman","Kristi","Asih","Remon","Dian",
"Irene","Rani","Prima","Ian","Herman")
)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
)
View(dbase)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi"),
"Supervisor",
"Admin")
)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(nama_asli == "Veronica","Manager",jabatan)
)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(nama_asli == "Veronica","Manager",jabatan),
ket = ifelse(nama_asli %in% c("Willy","Bembi","Erika","Reza","Arninta"),
"Dept lain",
"Dept sendiri")
)
knitr::kable(dbase)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(nama_asli == "Veronica","Manager",jabatan),
ket = ifelse(nama_asli %in% c("Willy","Bembi","Erika","Reza","Arninta",
"Scasia","Sony","Nanda","Ian","Indra","Rocky",
"Evelyn"),
"Dept lain",
"Dept sendiri")
)
dbase %>%
select(-nama_asli) %>%
knitr::kable()
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(nama_asli == "Veronica","Manager",jabatan),
ket = ifelse(nama_asli %in% c("Willy","Bembi","Erika","Reza","Arninta",
"Scasia","Sony","Nanda","Ian","Indra","Rocky",
"Evelyn"),
"Dept lain",
"Dept sendiri"),
no = c(1:35)
)
dbase %>%
select(no,alias,jabatan,ket) %>%
rename(nama = alias) %>%
knitr::kable()
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
betweenness(graf)
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap()))
ggraph(tbl_graph,layout = "gem") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = name)) +
coord_fixed() +
theme_void()
tbl_graph
dbase = select(nama_asli,alias) %>% rename(name = alias)
dbase = dbase %>% select(nama_asli,alias) %>% rename(name = alias)
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap())) %>%
merger(dbase)
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap())) %>%
merge(dbase)
tbl_graph
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
betweenness(graf)
dbase = dbase %>% select(nama_asli,alias) %>% rename(name = alias)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101.github.io/_posts/bukan nfi/feedback")
library(dplyr)
library(ggplot2)
library(igraph)
library(ggraph)
library(tidygraph)
data = data.frame(
from = c(rep("Anthony",4),rep("Asih",2),rep("Kristi",4),
rep("Dian",7),rep("Elizabeth",2),"Endy",rep("Herman",5),
rep("Irene",6),
rep("Prima",4),
rep("Novitalia",4),
rep("Nina",3),
rep("Rani",5),
rep("Remon",4),
rep("Scasia",3),
rep("Sony",2),
rep("Steffira",5),
rep("Theresia",3),
rep("Veronica",8),
rep("Yola",5)),
to = c("Nanda","Ade","Remon","Bembi",
"Riangga","Remon",
"Laksmi","Nina","Willy","Dian",
"Theresia","Scasia","Sony","Nina","Epin","Endy","Steffira",
"Reza","Asih",
"Herman",
"Endy","Steffira","Theresia","Novitalia","Irene",
"Steffira","Prima","Novitalia","Rani","Yola","Evelyn",
"Evelyn","Fahmi","Riangga","Asih",
"Nina","Herman","Rani","Steffira",
"Rocky","Dian","Erika",
"Irene","Novitalia","Endy","Nina","Yola",
"Anthony","Laksmi","Elizabeth","Willy",
"Dian","Sony","Indra",
"Dian","Theresia",
"Irene","Novitalia","Rani","Arninta","Prima",
"Dian","Sony","Ellyana",
"Elizabeth","Irene","Anthony","Herman","Kristi","Asih","Remon","Dian",
"Irene","Rani","Prima","Ian","Herman")
)
dbase = c(data$from,data$to)
dbase = unique(dbase)
dbase = data.frame(
nama_asli = dbase,
alias = randomNames::randomNames(35,which.names = "first")
) %>%
mutate(jabatan = ifelse(nama_asli %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(nama_asli == "Veronica","Manager",jabatan),
ket = ifelse(nama_asli %in% c("Willy","Bembi","Erika","Reza","Arninta",
"Scasia","Sony","Nanda","Ian","Indra","Rocky",
"Evelyn"),
"Dept lain",
"Dept sendiri"),
no = c(1:35)
)
dbase %>%
select(no,alias,jabatan,ket) %>%
rename(nama = alias) %>%
knitr::kable()
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
betweenness(graf)
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap()))
tbl_graph
tbl_graph[1]
graf = graph_from_data_frame(data)
tbl_graph = as_tbl_graph(graf)
hub_id = which.max(degree(graf))
betweenness(graf)
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap()),
jabatan = ifelse(name %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(name == "Veronica","Manager",jabatan),
ket = ifelse(name %in% c("Willy","Bembi","Erika","Reza","Arninta",
"Scasia","Sony","Nanda","Ian","Indra","Rocky",
"Evelyn"),
"Dept lain",
"Dept sendiri"))
tbl_graph
dbase
a = "Arninta"
match(a,dbase)
match(a,dbase$nama_asli)
dbase$alias[match(a,dbase$nama_asli)]
tbl_graph =
tbl_graph %>%
activate(nodes) %>%
mutate(degree = degree(graf),
cluster = as.factor(group_infomap()),
jabatan = ifelse(name %in% c("Remon","Anthony",
"Novitalia","Elizabeth",
"Arninta","Asih","Kristi",
"Dian","Irene","Herman","Rani","Laksmi",
"Willy","Bembi","Reza"),
"Supervisor",
"Admin"),
jabatan = ifelse(name == "Veronica","Manager",jabatan),
ket = ifelse(name %in% c("Willy","Bembi","Erika","Reza","Arninta",
"Scasia","Sony","Nanda","Ian","Indra","Rocky",
"Evelyn"),
"Dept lain",
"Dept sendiri"),
alias = dbase$alias[match(name,dbase$nama_asli)])
tbl_graph
ggraph(tbl_graph,layout = "gem") +
geom_edge_link() +
geom_node_point(aes(color = cluster,size = degree)) +
geom_node_text(aes(label = alias)) +
coord_fixed() +
theme_void()
ggraph(tbl_graph,layout = "gem") +
geom_edge_link() +
geom_node_label(aes(label = alias))
ggraph(tbl_graph,layout = "fr") +
geom_edge_link() +
geom_node_label(aes(label = alias))
ggraph(tbl_graph,layout = "graphopt") +
geom_edge_link() +
geom_node_label(aes(label = alias))
ggraph(tbl_graph,layout = "dl") +
geom_edge_link() +
geom_node_label(aes(label = alias))
ggraph(tbl_graph,layout = "circle") +
geom_edge_link() +
geom_node_label(aes(label = alias))
