annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
source('~/Documents/ikanx101.com/_posts/nakes data/Bagian 3/algoritma k means.R', echo=TRUE)
rm(list=ls())
load("hasil kmeans.rda")
data %>%
group_by(cluster) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(cluster = paste0("Cluster ",cluster)) %>%
ggplot(aes(x = cluster,
y = n)) +
geom_col(fill = "brown",color = "black") +
geom_label(aes(label = n)) +
theme_wsj() +
labs(title = "Berapa banyak kabupaten kota yang termasuk ke dalam\nmasing-masing cluster?",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme(axis.text.y = element_blank(),
plot.title = element_text(size = 13),
plot.subtitle = element_text(size=12),
plot.caption = element_text(size=10))
new = data.frame(hasil$centers)
new$cluster = paste0("Cluster ",c(1:5))
new %>%
reshape2::melt(id.vars = "cluster") %>%
mutate(variable = gsub("\\_"," ",variable),
variable = stringr::str_to_title(variable),
label = case_when(value <= 2 ~ "Very Low",
value > 2 & value < 3 ~ "So So",
value >= 3 & value < 5 ~ "Good",
value >= 5 & value < 6 ~ "High",
value >= 6 ~ "Gold")
) %>%
ggplot(aes(x = cluster,
y = variable,
fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "darkred",high = "gold",midpoint = 4) +
geom_text(aes(label = label),color = "black",face = "bold") +
labs(title = "Karakteristik Masing-Masing Cluster",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
new = data.frame(hasil$centers)
new$cluster = paste0("Cluster ",c(1:5))
new %>%
reshape2::melt(id.vars = "cluster") %>%
mutate(variable = gsub("\\_"," ",variable),
variable = stringr::str_to_title(variable),
label = case_when(value <= 2 ~ "Very Low",
value > 2 & value < 3 ~ "So So",
value >= 3 & value < 5 ~ "Good",
value >= 5 & value < 6 ~ "High",
value >= 6 ~ "Gold")
) %>%
ggplot(aes(x = cluster,
y = variable,
fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "darkred",high = "gold",midpoint = 4) +
geom_text(aes(label = label),color = "black",face = "bold") +
labs(title = "Karakteristik Masing-Masing Cluster",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/ikanx101.com/_posts/HBR")
rm(list=ls())
library(dplyr)
library(tidytext)
library(ggplot2)
library(ggthemes)
library(wordcloud2)
load("/home/ikanx101githubio/Documents/belajaR/Bukan Infografis/HBR/clean.rda")
nomnoml::nomnoml("[Tujuan|
[14 Artikel HBR] -> [7 Artikel Leadership]
[14 Artikel HBR] -> [7 Artikel Technology]
[7 Artikel Leadership] -- [Apakah ada perbedaan?]
[7 Artikel Technology] -- [Apakah ada perbedaan?]
]
")
leader_wc =
new %>%
filter(kategori == "leadership") %>%
unnest_tokens("words",baca) %>%
group_by(words) %>%
summarise(n = n()) %>%
arrange(desc(n))
wc = wordcloud2::wordcloud2(leader_wc,color = "random-dark")
library(htmlwidgets)
saveWidget(wc,"1.html",selfcontained = F)
webshot::webshot("1.html","wordcloud1.png",vwidth = 1200, vheight = 1000, delay = 40)
tech_wc =
new %>%
filter(kategori == "technology") %>%
unnest_tokens("words",baca) %>%
group_by(words) %>%
summarise(n = n()) %>%
arrange(desc(n))
wc = wordcloud2::wordcloud2(tech_wc,color = "random-dark")
library(htmlwidgets)
saveWidget(wc,"1.html",selfcontained = F)
webshot::webshot("1.html","wordcloud2.png",vwidth = 1200, vheight = 1000, delay = 40)
leader_wc = leader_wc %>% rename(leader = n) %>% mutate(leader = leader / 1559)
tech_wc = tech_wc %>% rename(tech = n) %>% mutate(tech = tech / 1657)
data = merge(leader_wc,tech_wc)
data %>%
arrange(desc(leader)) %>%
head(20) %>%
knitr::kable("html",caption = "TOP 20 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
ggplot(aes(x = leader,
y = tech)) +
geom_point(alpha = 0.3, size = 2.5) +
geom_text(aes(label = words,
size = leader+tech), check_overlap = TRUE) +
geom_abline(color = "red") +
theme_tufte() +
theme(legend.position = "none") +
labs(x = "Kata-kata dari kategori LEADER",
y = "Kata-kata dari kategori TECHNOLOGY",
title = "Crosswords Analysis: Kata apa saja yang sering digunakan oleh dua kategori ini?",
subtitle = "Source: 14 Artikel HBR",
caption = "Visualized using R\nikanx101.com")
tes = cor.test(data$leader,data$tech)
tes
data %>%
mutate(log_ratio = log(leader / tech)) %>%
filter(abs(log_ratio) > 2) %>%
mutate(penanda = ifelse(log_ratio<0,"a","b")) %>%
group_by(penanda) %>%
ggplot(aes(x = reorder(words,log_ratio),
y = log_ratio)) +
geom_col(aes(fill = log_ratio<0)) +
scale_fill_manual(values = c("steelblue", "darkred"),name = "", labels = c("Leader", "Tech")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90,hjust = 1,size=7)) +
theme(legend.position = "bottom") +
labs(x = "Kata-Kata yang Digunakan",
y = "Log Odds Ratio",
title = "Log Odds Ratio antara Artikel Kategori Leadership dan Technology",
subtitle = "Source: 14 Artikel HBR") +
coord_flip()
data %>%
arrange(desc(leader)) %>%
head(20) %>%
rename(Words = words,
"% Leadership" = leader) %>%
knitr::kable("html",caption = "TOP 10 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
arrange(desc(leader)) %>%
head(20) %>%
mutate(leader = round(leader*100,2))
data %>%
arrange(desc(leader)) %>%
head(20) %>%
mutate(leader = round(leader*100,2),
tech = round(tect*100,2)) %>%
rename(Words = words,
"% Leadership" = leader,
"% Techonolgy" = tech) %>%
knitr::kable("html",caption = "TOP 10 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
arrange(desc(leader)) %>%
head(20) %>%
mutate(leader = round(leader*100,2),
tech = round(tech*100,2)) %>%
rename(Words = words,
"% Leadership" = leader,
"% Techonolgy" = tech) %>%
knitr::kable("html",caption = "TOP 10 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
arrange(desc(leader,tech)) %>%
head(20) %>%
mutate(leader = round(leader*100,2),
tech = round(tech*100,2)) %>%
rename(Words = words,
"% Leadership" = leader,
"% Technolgy" = tech) %>%
knitr::kable("html",caption = "TOP 10 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
arrange(desc(leader,tech)) %>%
head(20) %>%
mutate(leader = round(leader*100,2),
tech = round(tech*100,2)) %>%
rename(Words = words,
"% Leadership" = leader,
"% Technology" = tech) %>%
knitr::kable("html",caption = "Contoh: 10 Kata-Kata yang Beririsan dari 2 Kategori")
data %>%
mutate(log_ratio = log(leader / tech)) %>%
filter(abs(log_ratio) > 2) %>%
mutate(penanda = ifelse(log_ratio<0,"a","b")) %>%
group_by(penanda) %>%
ggplot(aes(x = reorder(words,log_ratio),
y = log_ratio)) +
geom_col(aes(fill = log_ratio<0)) +
scale_fill_manual(values = c("steelblue", "darkred"),name = "", labels = c("Leader", "Tech")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90,hjust = 1,size=7)) +
theme(legend.position = "bottom") +
labs(x = "Kata-Kata yang Digunakan",
y = "Log Odds Ratio",
title = "Log Odds Ratio antara Artikel Kategori Leadership dan Technology\nKata-kata Apa Saja yang Most Likely Berasal dari Masing-masing Kategori",
subtitle = "Source: 14 Artikel HBR") +
coord_flip()
data %>%
mutate(log_ratio = log(leader / tech)) %>%
filter(abs(log_ratio) > 1.5) %>%
mutate(penanda = ifelse(log_ratio<0,"a","b")) %>%
group_by(penanda) %>%
ggplot(aes(x = reorder(words,log_ratio),
y = log_ratio)) +
geom_col(aes(fill = log_ratio<0)) +
scale_fill_manual(values = c("steelblue", "darkred"),name = "", labels = c("Leader", "Tech")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90,hjust = 1,size=7)) +
theme(legend.position = "bottom") +
labs(x = "Kata-Kata yang Digunakan",
y = "Log Odds Ratio",
title = "Log Odds Ratio antara Artikel Kategori Leadership dan Technology\nKata-kata Apa Saja yang Most Likely Berasal dari Masing-masing Kategori",
subtitle = "Source: 14 Artikel HBR") +
coord_flip()
setwd("~/ikanx101com/_posts/friday 13th")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts/friday 13th")
rm(list=ls())
library(dplyr)
library(ggplot2)
library(ggthemes)
tanggal = seq(as.Date("01/01/2020"),as.Date("12/31/2050"))
tanggal = seq(as.Date("01/01/2020"),as.Date("31/12/2050"))
tanggal = seq(as.Date("01-01-2020"),as.Date("12-31-2050"))
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"))
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-31-12"))
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"),by = 1)
tanggal
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"),by = 1)
data = data.frame(
tanggal = tanggal,
hari = lubridate::wday(tanggal, label = T),
nomor = lubridate::day(tanggal)
)
View(data)
data %>%
filter(hari == "Fri" & angka == 13)
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"),by = 1)
data = data.frame(
tanggal = tanggal,
hari = lubridate::wday(tanggal, label = T),
angka = lubridate::day(tanggal),
tahun = lubridate::year(tanggal)
)
data %>%
filter(hari == "Fri" & angka == 13)
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"),by = 1)
data = data.frame(
tanggal = tanggal,
hari = lubridate::wday(tanggal, label = T),
angka = lubridate::day(tanggal),
bulan = lubridate::month(tanggal,label = T),
tahun = lubridate::year(tanggal)
)
data %>%
filter(hari == "Fri" & angka == 13)
data %>%
filter(hari == "Fri" & angka == 13) %>%
group_by(tahun) %>%
summarise(freq = n(),
terjadi_saat = stringr::str_c(bulan,sep = ",")) %>%
ungroup()
data %>%
filter(hari == "Fri" & angka == 13) %>%
group_by(tahun) %>%
summarise(freq = n(),
terjadi_saat = stringr::str_c(bulan,collapse = ",")) %>%
ungroup()
hasil %>%
head(10) %>%
knitr("html",caption = "")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts/friday 13th")
rm(list=ls())
library(dplyr)
library(ggplot2)
library(ggthemes)
tanggal = seq(as.Date("2020-01-01"),as.Date("2050-12-31"),by = 1)
data = data.frame(
tanggal = tanggal,
hari = lubridate::wday(tanggal, label = T),
angka = lubridate::day(tanggal),
bulan = lubridate::month(tanggal,label = T),
tahun = lubridate::year(tanggal)
)
hasil =
data %>%
filter(hari == "Fri" & angka == 13) %>%
group_by(tahun) %>%
summarise(freq = n(),
terjadi_saat = stringr::str_c(bulan,collapse = ",")) %>%
ungroup()
hasil %>%
head(10) %>%
knitr("html",caption = "10 Data Teratas")
hasil %>%
head(10) %>%
knitr::kable("html",caption = "10 Data Teratas")
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_text(aes(label = terjadi_saat))
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_text(aes(label = terjadi_saat),
angle = 90)
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat),
angle = 90)
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_text(aes(label = terjadi_saat),
angle = 90) +
theme_economist()
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_text(aes(label = terjadi_saat),
angle = 90) +
theme_economist() +
coord_flip()
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_text(aes(label = terjadi_saat)) +
theme_economist() +
coord_flip()
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat)) +
theme_economist() +
coord_flip() +
theme(legend.position = "none")
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat)) +
theme_economist() +
coord_flip() +
theme(legend.position = "none",
axis.title.y = element_blank()) +
labs(title = "Ada berapa kali Jumat tanggal 13 muncul setiap tahunnya?",
subtitle = "Tahun 2020 hingga 2050",
x = "Berapa kali terjadi per tahun?",
caption = "Visualized using R\nikanx101.com")
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat),size = 3) +
theme_economist() +
coord_flip() +
theme(legend.position = "none",
axis.title.y = element_blank()) +
labs(title = "Ada berapa kali Jumat tanggal 13 muncul setiap tahunnya?",
subtitle = "Tahun 2020 hingga 2050",
x = "Berapa kali terjadi per tahun?",
caption = "Visualized using R\nikanx101.com")
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat),size = 3,hjust=0) +
theme_economist() +
coord_flip() +
theme(legend.position = "none",
axis.title.y = element_blank()) +
labs(title = "Ada berapa kali Jumat tanggal 13 muncul setiap tahunnya?",
subtitle = "Tahun 2020 hingga 2050",
x = "Berapa kali terjadi per tahun?",
caption = "Visualized using R\nikanx101.com")
hasil %>%
mutate(tahun = factor(tahun)) %>%
ggplot(aes(x = tahun,
y = freq)) +
geom_col(aes(fill = freq),
color = "black") +
geom_label(aes(label = terjadi_saat),size = 3,hjust=1) +
theme_economist() +
coord_flip() +
theme(legend.position = "none",
axis.title.y = element_blank()) +
labs(title = "Ada berapa kali Jumat tanggal 13 muncul setiap tahunnya?",
subtitle = "Tahun 2020 hingga 2050",
x = "Berapa kali terjadi per tahun?",
caption = "Visualized using R\nikanx101.com")
