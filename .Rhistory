ggplot(aes(x = reorder(nama_kab_kota,dokter_umum),
y = dokter_umum)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 150,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 100,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Umum per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_spesialis)
median_umum = median(data$dokter_spesialis)
head =
data %>%
arrange(desc(dokter_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head  %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_spesialis),
y = dokter_spesialis)) +
geom_col(fill = "steelblue") +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 30,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_sub_spesialis)
median_umum = median(data$dokter_sub_spesialis)
head =
data %>%
arrange(desc(dokter_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_sub_spesialis),
y = dokter_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
data =
data %>%
filter(!grepl("jakarta",nama_kab_kota,ignore.case = T)) %>%
select(nama_kab_kota,
provinsi,
dokter_umum,
dokter_spesialis,
dokter_sub_spesialis,
dokter_gigi,
dokter_gigi_spesialis_dan_sub_spesialis) %>%
mutate(dokter_umum = cut(dokter_umum,breaks=7,labels=c(1:7)),
dokter_spesialis = cut(dokter_spesialis,breaks=7,labels=c(1:7)),
dokter_sub_spesialis = cut(dokter_sub_spesialis,breaks=7,labels=c(1:7)),
dokter_gigi = cut(dokter_gigi,breaks=7,labels=c(1:7)),
dokter_gigi_spesialis_dan_sub_spesialis = cut(dokter_gigi_spesialis_dan_sub_spesialis,breaks=7,labels=c(1:7))
)
data_cluster = data %>% select(-nama_kab_kota,-provinsi) %>% mutate_if(is.factor,as.numeric)
library(factoextra)
library(cluster)
# fviz_nbclust(data_cluster, kmeans, method = "wss")
hasil = kmeans(data_cluster, 5, nstart = 25)
data$cluster = hasil$cluster
save(data,file = "hasil kmeans.rda")
data %>%
group_by(cluster) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(cluster = paste0("Cluster ",cluster)) %>%
ggplot(aes(x = cluster,
y = n)) +
geom_col(fill = "brown",color = "black") +
geom_label(aes(label = n)) +
theme_wsj() +
labs(title = "Berapa banyak kabupaten kota yang termasuk ke dalam\nmasing-masing cluster?",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme(axis.text.y = element_blank(),
plot.title = element_text(size = 13),
plot.subtitle = element_text(size=12),
plot.caption = element_text(size=10))
new = data.frame(hasil$centers)
new$cluster = paste0("Cluster ",c(1:5))
new %>%
reshape2::melt(id.vars = "cluster") %>%
mutate(variable = gsub("\\_"," ",variable),
variable = stringr::str_to_title(variable),
label = case_when(value <= 2 ~ "Very Low",
value > 2 & value < 3 ~ "So So",
value >= 3 & value < 5 ~ "Good",
value >= 5 & value < 6 ~ "High",
value >= 6 ~ "Gold")
) %>%
ggplot(aes(x = cluster,
y = variable,
fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "darkred",high = "gold",midpoint = 4) +
geom_text(aes(label = label),color = "black",face = "bold") +
labs(title = "Karakteristik Masing-Masing Cluster",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
data %>%
arrange(cluster) %>%
select(nama_kab_kota,cluster)
rm(list=ls())
data = load("hasil kmeans.rda")
data %>%
group_by(cluster) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(cluster = paste0("Cluster ",cluster)) %>%
ggplot(aes(x = cluster,
y = n)) +
geom_col(fill = "brown",color = "black") +
geom_label(aes(label = n)) +
theme_wsj() +
labs(title = "Berapa banyak kabupaten kota yang termasuk ke dalam\nmasing-masing cluster?",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme(axis.text.y = element_blank(),
plot.title = element_text(size = 13),
plot.subtitle = element_text(size=12),
plot.caption = element_text(size=10))
load("~/Documents/ikanx101.com/_posts/nakes data/Bagian 3/hasil kmeans.rda")
rm(list=ls())
load("hasil kmeans.rda")
data %>%
group_by(cluster) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(cluster = paste0("Cluster ",cluster)) %>%
ggplot(aes(x = cluster,
y = n)) +
geom_col(fill = "brown",color = "black") +
geom_label(aes(label = n)) +
theme_wsj() +
labs(title = "Berapa banyak kabupaten kota yang termasuk ke dalam\nmasing-masing cluster?",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme(axis.text.y = element_blank(),
plot.title = element_text(size = 13),
plot.subtitle = element_text(size=12),
plot.caption = element_text(size=10))
new = data.frame(hasil$centers)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/ikanx101.com/_posts/nakes data/Bagian 3")
rm(list=ls())
library(readxl)
library(dplyr)
library(ggplot2)
library(ggthemes)
data =
read_excel("~/Documents/ikanx101.com/_posts/nakes data/Bagian 2/Data Dokter.xlsx") %>%
janitor::clean_names()
nama = gsub("\\_"," ",colnames(data)[4:8])
stringr::str_to_title(nama)
mean_umum = mean(data$dokter_umum)
median_umum = median(data$dokter_umum)
head =
data %>%
arrange(desc(dokter_umum)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_umum)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_umum),
y = dokter_umum)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 150,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 100,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Umum per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_spesialis)
median_umum = median(data$dokter_spesialis)
head =
data %>%
arrange(desc(dokter_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head  %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_spesialis),
y = dokter_spesialis)) +
geom_col(fill = "steelblue") +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 30,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_sub_spesialis)
median_umum = median(data$dokter_sub_spesialis)
head =
data %>%
arrange(desc(dokter_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_sub_spesialis),
y = dokter_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
source('~/Documents/ikanx101.com/_posts/nakes data/Bagian 3/algoritma k means.R', echo=TRUE)
rm(list=ls())
load("hasil kmeans.rda")
data %>%
group_by(cluster) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(cluster = paste0("Cluster ",cluster)) %>%
ggplot(aes(x = cluster,
y = n)) +
geom_col(fill = "brown",color = "black") +
geom_label(aes(label = n)) +
theme_wsj() +
labs(title = "Berapa banyak kabupaten kota yang termasuk ke dalam\nmasing-masing cluster?",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme(axis.text.y = element_blank(),
plot.title = element_text(size = 13),
plot.subtitle = element_text(size=12),
plot.caption = element_text(size=10))
new = data.frame(hasil$centers)
new$cluster = paste0("Cluster ",c(1:5))
new %>%
reshape2::melt(id.vars = "cluster") %>%
mutate(variable = gsub("\\_"," ",variable),
variable = stringr::str_to_title(variable),
label = case_when(value <= 2 ~ "Very Low",
value > 2 & value < 3 ~ "So So",
value >= 3 & value < 5 ~ "Good",
value >= 5 & value < 6 ~ "High",
value >= 6 ~ "Gold")
) %>%
ggplot(aes(x = cluster,
y = variable,
fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "darkred",high = "gold",midpoint = 4) +
geom_text(aes(label = label),color = "black",face = "bold") +
labs(title = "Karakteristik Masing-Masing Cluster",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
new = data.frame(hasil$centers)
new$cluster = paste0("Cluster ",c(1:5))
new %>%
reshape2::melt(id.vars = "cluster") %>%
mutate(variable = gsub("\\_"," ",variable),
variable = stringr::str_to_title(variable),
label = case_when(value <= 2 ~ "Very Low",
value > 2 & value < 3 ~ "So So",
value >= 3 & value < 5 ~ "Good",
value >= 5 & value < 6 ~ "High",
value >= 6 ~ "Gold")
) %>%
ggplot(aes(x = cluster,
y = variable,
fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "darkred",high = "gold",midpoint = 4) +
geom_text(aes(label = label),color = "black",face = "bold") +
labs(title = "Karakteristik Masing-Masing Cluster",
subtitle = "Base: 514 Kabupaten dan Kota",
caption = "Visualized using R\nikanx101.com") +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
