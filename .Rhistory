<<<<<<< HEAD
library(ggplot2)
library(ggpubr)
data = read.csv("/home/ikanx101githubio/Documents/belajaR/Bukan Infografis/EPL/EPL.csv")
knitr::kable(head(data,5),
caption = "Sampel Data EPL musim 2019/2020")
data = janitor::clean_names(data)
data %>% group_by(ftr) %>% summarise(n())
home =
data %>%
group_by(home_team) %>%
summarise(home_goal = sum(fthg)) %>%
ungroup() %>%
rename(teams = home_team)
away =
data %>%
group_by(away_team) %>%
summarise(away_goal = sum(ftag)) %>%
ungroup() %>%
rename(teams = away_team)
all_goals = merge(home,away) %>% mutate(total_goals = home_goal+away_goal) %>% arrange(desc(total_goals))
knitr::kable(all_goals,
caption = "Perbandingan Goal Tim Saat Bermain Kandang dan Tandang")
all_goals %>%
select(-total_goals) %>%
reshape2::melt(id.vars = "teams") %>%
mutate(variable = ifelse(variable == "home_goal","Home","Away")) %>%
ggplot(aes(x = reorder(teams,-value),
y = value)) +
geom_col(aes(fill = value),color = "black") +
geom_label(aes(label = value,fill=value),size = 2) +
scale_fill_gradient(low="steelblue",high="darkred") +
facet_wrap(~variable,scales = "free",ncol = 1,nrow = 2) +
scale_x_discrete(guide = guide_axis(n.dodge=3)) +
theme_pubclean() +
theme(legend.position = "none",
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 7,face = "bold"),
strip.background = element_rect(colour="black",
fill="white",
size=1,
linetype="solid")) +
labs(title = "Banyaknya Goal Home vs Away per Tim",
subtitle = "English Premier League 2019/2020",
x = "Tim",
y = "Sum of Goals")
all_goals %>%
mutate(keterangan = case_when(home_goal == away_goal ~ "Sama",
home_goal > away_goal ~ "Home lebih banyak",
home_goal < away_goal ~ "Away lebih banyak")
) %>%
group_by(keterangan) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(persen = freq / sum(freq),
persen = persen*100,
persen = round(persen,1),
persen = paste0(keterangan,": ",persen,"%")) %>%
ggplot(aes(x = "",
y = freq,
fill = keterangan)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
geom_label(aes(label = persen),position = position_stack(vjust = 0.5),size=4.5) +
=======
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Kondisi Pertandingan Sebelum COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_pre," pertandingan"))
new %>%
filter(kondisi == "Saat COVID") %>%
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
theme_pubclean() +
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
<<<<<<< HEAD
labs(title = "Proporsi Tim dengan Banyak Goal Terbanyak\npada Laga Home vs Away",
subtitle = "English Premier League 2019/2020")
data %>%
mutate(id = c(1:380)) %>%
select(id,fthg,ftag) %>%
reshape2::melt(id.vars = "id") %>%
mutate(variable = ifelse(variable == "fthg","Home","Away")) %>%
ggplot(aes(x = variable,
y = value)) +
geom_jitter(shape = 5,alpha=.7,color = "steelblue") +
geom_boxplot(alpha = .6,aes(fill = variable),color = "darkred") +
theme_pubclean() +
labs(y = "Goals",
title = "Sebaran Goal Tim Pada Laga Kandang dan Laga Tandang",
subtitle = "English Premier League 2019/2020") +
theme(legend.position = "none",
axis.title.x = element_blank())
=======
labs(title = "Kondisi Pertandingan Saat COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_cov," pertandingan"))
new
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
ggthemes::theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12)) +
labs(title = "Perbandingan Pemenang Laga Sebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
ggthemes::theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12)) +
labs(title = "Perbandingan Pemenang Laga\nSebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2.5) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
ggthemes::theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12),
axis.text.x = element_text(size=6)) +
labs(title = "Perbandingan Pemenang Laga\nSebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2.5) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
ggthemes::theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12),
axis.text.x = element_text(size=8)) +
labs(title = "Perbandingan Pemenang Laga\nSebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts/EPL v2")
rm(list=ls())
library(dplyr)
library(ggplot2)
library(ggpubr)
library(ggthemes)
data = read.csv("~/belajaR/Bukan Infografis/EPL/EPL.csv")
data = janitor::clean_names(data)
data =
data %>%
mutate(date = as.Date(date,format = "%d/%m/%Y"),
kondisi = ifelse(date <= "2020-03-09","Pre COVID","Saat COVID"),
ftr = case_when(ftr == "A" ~ "Away team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home team menang"),
ftr = factor(ftr, levels = c("Away team menang",
"Seri",
"Home team menang")),
kondisi = factor(kondisi, levels = c("Pre COVID","Saat COVID")))
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
data %>%
group_by(kondisi) %>%
summarise(freq = n()) %>%
<<<<<<< HEAD
ungroup() %>%
mutate(value = factor(value)) %>%
ggplot(aes(x = value,
y = freq)) +
geom_col(aes(fill = variable),position = "dodge",color = "black",alpha = .7) +
geom_line(aes(group = variable,
color = variable),
size = 1.5,
alpha = .7) +
theme_pubclean() +
labs(y = "Frekuensi",
x = "Berapa banyak goal?",
title = "Sebaran Goal Tim Pada Laga Kandang dan Laga Tandang",
subtitle = "English Premier League 2019/2020",
fill = "Keterangan",
color = "Keterangan") +
theme(legend.position = "bottom")
perbandingan =
data %>%
mutate(id = c(1:380)) %>%
select(id,fthg,ftag) %>%
reshape2::melt(id.vars = "id") %>%
mutate(variable = ifelse(variable == "fthg","Home","Away")) %>%
group_by(variable) %>%
summarise(rata = mean(value),
st_dev = sd(value)) %>%
ungroup() %>%
rename(`Jenis Laga` = variable,
`Rata-Rata Goal` = rata,
`Standar Deviasi` = st_dev)
knitr::kable(perbandingan,
caption = "Perbandingan Goal EPL")
test = t.test(data$fthg,data$ftag)
test
hasil = ifelse(test$p.value<0.05,
"Rata-rata goal antara Home dan Away berbeda",
"Tidak ada perbedaan rata-rata goal Home dan Away")
print(hasil)
data %>%
mutate(id = c(1:380),
diff = fthg - ftag) %>%
group_by(diff) %>%
summarise(freq = n()) %>%
ggplot(aes(x = diff,
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
theme_pubclean() +
labs(y = "Frekuensi",
x = "Selisih Gol",
title = "Sebaran Selisih Goal yang Terjadi di Semua Pertandingan\nGoal Home minus Goal Away",
subtitle = "English Premier League 2019/2020") +
theme(legend.position = "none")
prop.test(c(116,172),c(380,380))
data %>% group_by(ftr) %>% summarise(freq = n()) %>%
mutate(hasil_akhir = case_when(ftr == A ~ "Away Team menang",
ftr == D ~ "Seri",
ftr == H ~ "Home Team menang"))
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == A ~ "Away Team menang",
ftr == D ~ "Seri",
ftr == H ~ "Home Team menang"))
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup()
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == A ~ "Away Team menang",
ftr == D ~ "Seri",
ftr == H ~ "Home Team menang")
)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang")
)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq)
)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1)
)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black")
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
geom_label(aes(label = persen))
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="cyan",high="magenta") +
geom_label(aes(label = persen))
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean()
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean() +
labs(title = "Siapa Pemenang Laga di Premier League?",
subtitle = "English Premier League 2019/2020",
x = "Pemenang",
y = "Frequency")
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,-freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean() +
labs(title = "Siapa Pemenang Laga di Premier League?",
subtitle = "English Premier League 2019/2020",
x = "Pemenang",
y = "Frequency") +
coord_flip()
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean() +
labs(title = "Siapa Pemenang Laga di Premier League?",
subtitle = "English Premier League 2019/2020",
x = "Pemenang",
y = "Frequency") +
coord_flip()
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean() +
labs(title = "Siapa Pemenang Laga di Premier League?",
subtitle = "English Premier League 2019/2020",
x = "Pemenang",
y = "Frequency") +
coord_flip() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
)
tes_menang = prop.test(c(172,116),c(380,380))
tes_menang
tes_menang = prop.test(c(172,116),c(380,380))
tes_menang
tes_menang$p.value<0.05
ifelse(tes_menang$p.value<0.05,"Tolak H0","Terima H0")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/ikanx101.com/_posts/EPL")
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggpubr)
data = read.csv("/home/ikanx101githubio/Documents/belajaR/Bukan Infografis/EPL/EPL.csv")
knitr::kable(head(data,5),
caption = "Sampel Data EPL musim 2019/2020")
data = janitor::clean_names(data)
data %>% group_by(ftr) %>% summarise(freq = n()) %>% ungroup() %>%
mutate(hasil_akhir = case_when(ftr == "A" ~ "Away Team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home Team menang"),
persen = freq / sum(freq),
persen = round(persen*100,1),
persen = paste0(persen,"%")
) %>%
ggplot(aes(x = reorder(hasil_akhir,freq),
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
scale_fill_gradient(low="steelblue",high="darkred") +
geom_label(aes(label = persen)) +
theme_pubclean() +
labs(title = "Siapa Pemenang Laga di Premier League?",
subtitle = "English Premier League 2019/2020",
x = "Pemenang",
y = "Frequency") +
coord_flip() +
theme(legend.position = "none",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
tes_menang = prop.test(c(172,116),c(380,380))
tes_menang
ifelse(tes_menang$p.value<0.05,"Tolak H0","Terima H0")
home =
=======
rename(Kondisi = kondisi,
`Banyak pertandingan` = freq) %>%
knitr::kable("html",caption = "Tabel: Berapa banyak pertandingan yang dijalankan?")
new =
data %>%
group_by(kondisi,ftr) %>%
summarise(freq = n()) %>%
ungroup() %>%
group_by(kondisi) %>%
mutate(all_matches = sum(freq),
persen = freq/all_matches*100,
persen = round(persen,1),
persen = paste0(persen,"%"))
match_pre = max(new$all_matches)
match_cov = min(new$all_matches)
new %>%
filter(kondisi == "Pre COVID") %>%
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
theme_wsj() +
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Kondisi Pertandingan Sebelum COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_pre," pertandingan"))
new %>%
filter(kondisi == "Saat COVID") %>%
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
theme_wsj() +
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Kondisi Pertandingan Saat COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_cov," pertandingan"))
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2.5) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12),
axis.text.x = element_text(size=8)) +
labs(title = "Perbandingan Pemenang Laga\nSebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts/EPL v2")
rm(list=ls())
library(dplyr)
library(ggplot2)
library(ggpubr)
library(ggthemes)
data = read.csv("~/belajaR/Bukan Infografis/EPL/EPL.csv")
data = janitor::clean_names(data)
data =
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
data %>%
mutate(date = as.Date(date,format = "%d/%m/%Y"),
kondisi = ifelse(date <= "2020-03-09","Pre COVID","Saat COVID"),
ftr = case_when(ftr == "A" ~ "Away team menang",
ftr == "D" ~ "Seri",
ftr == "H" ~ "Home team menang"),
ftr = factor(ftr, levels = c("Away team menang",
"Seri",
"Home team menang")),
kondisi = factor(kondisi, levels = c("Pre COVID","Saat COVID")))
data %>%
<<<<<<< HEAD
group_by(away_team) %>%
summarise(away_goal = sum(ftag)) %>%
ungroup() %>%
rename(teams = away_team)
all_goals = merge(home,away) %>% mutate(total_goals = home_goal+away_goal) %>% arrange(desc(total_goals))
knitr::kable(all_goals,
caption = "Perbandingan Goal Tim Saat Bermain Kandang dan Tandang")
all_goals %>%
select(-total_goals) %>%
reshape2::melt(id.vars = "teams") %>%
mutate(variable = ifelse(variable == "home_goal","Home","Away")) %>%
ggplot(aes(x = reorder(teams,-value),
y = value)) +
geom_col(aes(fill = value),color = "black") +
geom_label(aes(label = value,fill=value),size = 2) +
scale_fill_gradient(low="steelblue",high="darkred") +
facet_wrap(~variable,scales = "free",ncol = 1,nrow = 2) +
scale_x_discrete(guide = guide_axis(n.dodge=3)) +
theme_pubclean() +
theme(legend.position = "none",
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 7,face = "bold"),
strip.background = element_rect(colour="black",
fill="white",
size=1,
linetype="solid")) +
labs(title = "Banyaknya Goal Home vs Away per Tim",
subtitle = "English Premier League 2019/2020",
x = "Tim",
y = "Sum of Goals")
all_goals %>%
mutate(keterangan = case_when(home_goal == away_goal ~ "Sama",
home_goal > away_goal ~ "Home lebih banyak",
home_goal < away_goal ~ "Away lebih banyak")
) %>%
group_by(keterangan) %>%
=======
group_by(kondisi) %>%
summarise(freq = n()) %>%
rename(Kondisi = kondisi,
`Banyak pertandingan` = freq) %>%
knitr::kable("html",caption = "Tabel: Berapa banyak pertandingan yang dijalankan?")
new =
data %>%
group_by(kondisi,ftr) %>%
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
summarise(freq = n()) %>%
ungroup() %>%
group_by(kondisi) %>%
mutate(all_matches = sum(freq),
persen = freq/all_matches*100,
persen = round(persen,1),
<<<<<<< HEAD
persen = paste0(keterangan,": ",persen,"%")) %>%
=======
persen = paste0(persen,"%"))
match_pre = max(new$all_matches)
match_cov = min(new$all_matches)
new %>%
filter(kondisi == "Pre COVID") %>%
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
theme_pubclean() +
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
<<<<<<< HEAD
labs(title = "Proporsi Tim dengan Banyak Goal Terbanyak\npada Laga Home vs Away",
subtitle = "English Premier League 2019/2020")
data %>%
mutate(id = c(1:380)) %>%
select(id,fthg,ftag) %>%
reshape2::melt(id.vars = "id") %>%
mutate(variable = ifelse(variable == "fthg","Home","Away")) %>%
ggplot(aes(x = variable,
y = value)) +
geom_jitter(shape = 5,alpha=.7,color = "steelblue") +
geom_boxplot(alpha = .6,aes(fill = variable),color = "darkred") +
=======
labs(title = "Kondisi Pertandingan Sebelum COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_pre," pertandingan"))
new %>%
filter(kondisi == "Saat COVID") %>%
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
theme_pubclean() +
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Kondisi Pertandingan Saat COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_cov," pertandingan"))
new %>%
ggplot(aes(x = ftr,
y = freq)) +
geom_col(aes(fill = freq)) +
geom_label(aes(label = paste0("n: ",freq,"\nPercent: ",persen),
fill = freq),
color = "white",
size = 2.5) +
scale_fill_gradient(low = "steelblue",high = "darkred") +
facet_wrap(~kondisi) +
theme_wsj() +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12),
axis.text.x = element_text(size=8)) +
labs(title = "Perbandingan Pemenang Laga\nSebelum dan Saat COVID",
subtitle = "Data English Premier League 2019/2020")
new =
data %>%
group_by(kondisi,ftr) %>%
summarise(freq = n()) %>%
ungroup() %>%
group_by(kondisi) %>%
mutate(all_matches = sum(freq),
persen = freq/all_matches*100,
persen = round(persen,1),
persen = paste0(persen,"%"))
match_pre = max(new$all_matches)
match_cov = min(new$all_matches)
new %>%
filter(kondisi == "Pre COVID") %>%
ggplot(aes(x = "",
y = freq,
fill = ftr)) +
geom_bar(stat = "identity") +
scale_fill_brewer(palette="Set2") +
coord_polar("y", start=0) +
ggrepel::geom_label_repel(aes(label = paste(ftr,persen,sep = "\n")),position = position_stack(vjust = 0.5)) +
theme_pubclean() +
theme(panel.grid=element_blank(),
panel.background = element_blank(),
axis.title=element_blank(),
legend.position = 'none',
axis.text = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Kondisi Pertandingan Sebelum COVID",
subtitle = "Data English Premier League 2019/2020",
caption = paste0("base: ",match_pre," pertandingan"))
new
hasil = prop.test(c(43,129),c(92,288))
hasil
ifelse(hasil$p.value<0.05,"Tolak H0","H0 tidak ditolak")
hasil$p.value
hasil = prop.test(c(29,87),c(92,288))
hasil
ifelse(hasil$p.value<0.05,"Tolak H0","H0 tidak ditolak")
hasil = prop.test(c(43,29),c(92,92))
hasil
hasil = prop.test(c(129,87),c(288,288))
hasil
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home)) +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1)
data %>%
<<<<<<< HEAD
mutate(id = c(1:380),
diff = fthg - ftag) %>%
group_by(diff) %>%
summarise(freq = n()) %>%
ggplot(aes(x = diff,
y = freq)) +
geom_col(aes(fill = freq),color = "black") +
theme_pubclean() +
labs(y = "Frekuensi",
x = "Selisih Gol",
title = "Sebaran Selisih Goal yang Terjadi di Semua Pertandingan\nGoal Home minus Goal Away",
subtitle = "English Premier League 2019/2020") +
theme(legend.position = "none")
View(data)
test = t.test(data$fthg,data$ftag)
test
hasil = ifelse(test$p.value<0.05,
"Tolak H0",
"H0 tidak ditolak")
print(hasil)
=======
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home)) +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1) +
theme_wsj()
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1) +
theme_wsj()
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1) +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh Home Team")
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1,
color = "steelblue") +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh Home Team")
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1,
color = "steelblue") +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh Home Team",
subtitle = "Data English Premier League 2019/2020") +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12))
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1,
color = "steelblue") +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh\nHome Team",
subtitle = "Data English Premier League 2019/2020") +
theme(axis.text.y = element_blank(),
legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12))
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_home,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_home - sd_home,
ymax = gol_home + sd_home),width = .1,
color = "steelblue") +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh\nHome Team",
subtitle = "Data English Premier League 2019/2020") +
theme(legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12))
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
ggplot() +
geom_col(aes(x = kondisi,
y = gol_away,
fill = kondisi),
color = "black") +
geom_errorbar(aes(x = kondisi,
ymin = gol_away - sd_away,
ymax = gol_away + sd_away),width = .1,
color = "steelblue") +
theme_wsj() +
labs(title = "Perbandingan Goal yang Diciptakan oleh\nAway Team",
subtitle = "Data English Premier League 2019/2020") +
theme(legend.position = "none",
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 12))
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag))
data %>%
group_by(kondisi) %>%
summarise(gol_home = mean(fthg),
sd_home = sd(fthg),
gol_away = mean(ftag),
sd_away = sd(ftag)) %>%
rename(Kondisi = kondisi,
`Goal Home Team` = gol_home,
`StDev Goal Home Team` = sd_home)
test_1 = t.test(fthg~kondisi,data)
test_1
ifelse(test_1$p.value<0.05,"Tolak H0","H0 tidak ditolak")
test_1 = t.test(fthg~kondisi,data)
test_1
ifelse(test_1$p.value<0.05,"Tolak H0","H0 tidak ditolak")
test_1$p.value
test_1 = t.test(ftag~kondisi,data)
test_1
ifelse(test_1$p.value<0.05,"Tolak H0","H0 tidak ditolak")
>>>>>>> ead088739184e02da4dbefc8c5067f197263149e
