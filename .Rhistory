label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
tutup_botol()
punya = c(1,2,3,4)
punya %in% c(1,2)
punya %in% c(1,2,3)
tes = punya %in% c(1,2,3)
sum(tes)
beli_botol = function(){
iter = 0
punya = c()
while(syarat < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
beli_botol()
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
beli_botol = function(){
iter = 0
punya = c()
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
beli_botol()
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
beli_botol()
beli_botol()
beli_botol()
beli_botol()
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:3),1,replace = T, prob = c(3/5,1/5,1/5))
}
beli_botol = function(){
punya = c()
while(length(unique(punya))<3){
punya = c(punya,tutup_botol())
}
length(punya)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts")
library(dplyr)
library(ggplot2)
library(ggthemes)
knitr::include_graphics("https://raw.githubusercontent.com/ikanx101/ikanx101.github.io/master/_posts/coupon-collector-new_files/urban%20mama.png")
tutup_botol = function(){
sample(c(1:3),1,replace = T)
}
beli_botol = function(){
punya = c()
while(length(unique(punya))<3){
punya = c(punya,tutup_botol())
}
length(punya)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:3),1,replace = T, prob = c(5/7,1/7,1/7))
}
beli_botol = function(){
punya = c()
while(length(unique(punya))<3){
punya = c(punya,tutup_botol())
}
length(punya)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/ikanx101com/_posts")
library(dplyr)
library(ggplot2)
library(ggthemes)
knitr::include_graphics("https://raw.githubusercontent.com/ikanx101/ikanx101.github.io/master/_posts/coupon-collector-new_files/urban%20mama.png")
tutup_botol = function(){
sample(c(1:3),1,replace = T)
}
beli_botol = function(){
punya = c()
while(length(unique(punya))<3){
punya = c(punya,tutup_botol())
}
length(punya)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:3),1,replace = T, prob = c(5/7,1/7,1/7))
}
beli_botol = function(){
punya = c()
while(length(unique(punya))<3){
punya = c(punya,tutup_botol())
}
length(punya)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:4),1,replace = T)
}
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
tutup_botol = function(){
sample(c(1:4),1,replace = T,prob = c(6/10,2/10,1/10,1/10))
}
beli_botol = function(){
iter = 0
punya = c()
syarat = 0
while(sum(syarat) < 3){
punya = c(punya,tutup_botol())
punya = unique(punya)
syarat = punya %in% c(1:3)
iter = iter +1
}
return(iter)
}
iter = 500 #mau berapa x iterasi?
berapa_x_transaksi = replicate(iter,beli_botol())
data = data.frame(id = 1,es=berapa_x_transaksi) %>%
group_by(es) %>%
summarise(freq = n()) %>%
ungroup() %>%
mutate(prob = freq / sum(freq),
cum_prob = cumsum(prob),
label_prob = round(prob*100,1),
label_prob = paste0(label_prob,"%"),
label_cum_prob = round(cum_prob*100,1),
label_cum_prob = paste0(label_cum_prob,"%"))
es_min_d = data %>% filter(cum_prob > .9)
es_min = min(es_min_d$es)
es_max = max(es_min_d$es)
prob_min = min(es_min_d$cum_prob)*100
data %>%
ggplot(aes(x = es,
y = cum_prob)) +
geom_line(aes(group = 1),color = "darkred") +
ggrepel::geom_label_repel(aes(label = label_cum_prob,alpha = cum_prob),size = 2.5) +
labs(title = "Butuh berapa es krim yang dibeli agar mendapatkan 3 jenis stik hadiah?",
x = "Banyak es krim yang dibeli",
y = "Peluang kumulatif",
caption = "Simulasi menggunakan R\nikanx101.com",
subtitle = paste0("Saat membeli ",es_min," buah es krim, kita memiliki ",prob_min,"% peluang mendapatkan 3 jenis stik hadiah.\nSedangkan jika kita sudah membeli ",es_max," buah es krim, kita pasti mendapatkan semua jenis stik hadiah tersebut.")) +
theme_calc() +
theme(axis.text.y = element_blank(),
legend.position = "none")
