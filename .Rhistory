annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
data =
data %>%
select(nama_kab_kota,provinsi,dokter_umum,dokter_spesialis,dokter_sub_spesialis,dokter_gigi,dokter_gigi_spesialis_dan_sub_spesialis)
data =
data %>%
select(nama_kab_kota,
provinsi,
dokter_umum,
dokter_spesialis,
dokter_sub_spesialis,
dokter_gigi,
dokter_gigi_spesialis_dan_sub_spesialis) %>%
mutate(dokter_umum = cut(dokter_umum,5,levels = c(1:5)))
View(data)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/ikanx101.com/_posts/nakes data/Bagian 3")
rm(list=ls())
library(readxl)
library(dplyr)
library(ggplot2)
library(ggthemes)
data =
read_excel("~/Documents/ikanx101.com/_posts/nakes data/Bagian 2/Data Dokter.xlsx") %>%
janitor::clean_names()
colnames(data)[4:8]
mean_umum = mean(data$dokter_umum)
median_umum = median(data$dokter_umum)
head =
data %>%
arrange(desc(dokter_umum)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_umum)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_umum),
y = dokter_umum)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 150,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 100,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Umum per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_spesialis)
median_umum = median(data$dokter_spesialis)
head =
data %>%
arrange(desc(dokter_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head  %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_spesialis),
y = dokter_spesialis)) +
geom_col(fill = "steelblue") +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 30,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_sub_spesialis)
median_umum = median(data$dokter_sub_spesialis)
head =
data %>%
arrange(desc(dokter_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_sub_spesialis),
y = dokter_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
data =
data %>%
select(nama_kab_kota,
provinsi,
dokter_umum,
dokter_spesialis,
dokter_sub_spesialis,
dokter_gigi,
dokter_gigi_spesialis_dan_sub_spesialis) %>%
mutate(dokter_umum = cut(dokter_umum,breaks=5,labels=c(1:5))
)
View(data)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/ikanx101.com/_posts/nakes data/Bagian 3")
rm(list=ls())
library(readxl)
library(dplyr)
library(ggplot2)
library(ggthemes)
data =
read_excel("~/Documents/ikanx101.com/_posts/nakes data/Bagian 2/Data Dokter.xlsx") %>%
janitor::clean_names()
colnames(data)[4:8]
mean_umum = mean(data$dokter_umum)
median_umum = median(data$dokter_umum)
head =
data %>%
arrange(desc(dokter_umum)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_umum)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_umum),
y = dokter_umum)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 150,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 100,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Umum per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_spesialis)
median_umum = median(data$dokter_spesialis)
head =
data %>%
arrange(desc(dokter_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head  %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_spesialis),
y = dokter_spesialis)) +
geom_col(fill = "steelblue") +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 30,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_sub_spesialis)
median_umum = median(data$dokter_sub_spesialis)
head =
data %>%
arrange(desc(dokter_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_sub_spesialis),
y = dokter_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Sub Spesialis per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi)
median_umum = median(data$dokter_gigi)
head =
data %>%
arrange(desc(dokter_gigi)) %>%
head(30) %>%
mutate(detail = "TOP")
tail =
data %>%
arrange(desc(dokter_gigi)) %>%
tail(30) %>%
mutate(detail = "BOTTOM")
rbind(head,tail) %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi),
y = dokter_gigi)) +
geom_col(aes(fill = detail)) +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 50,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 20,
color='darkgreen') +
labs(title = "Top 30 vs Bottom 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
mean_umum = mean(data$dokter_gigi_spesialis_dan_sub_spesialis)
median_umum = median(data$dokter_gigi_spesialis_dan_sub_spesialis)
head =
data %>%
arrange(desc(dokter_gigi_spesialis_dan_sub_spesialis)) %>%
head(30) %>%
mutate(detail = "TOP")
head %>%
ggplot(aes(x = reorder(nama_kab_kota,dokter_gigi_spesialis_dan_sub_spesialis),
y = dokter_gigi_spesialis_dan_sub_spesialis)) +
geom_col(fill = "steelblue") +
scale_fill_manual(values = c("black","steelblue")) +
geom_hline(yintercept = mean_umum, color = "darkred",size = 1.2) +
geom_hline(yintercept = median_umum, color = "darkgreen",size = 1.2) +
coord_flip() +
annotate(geom='label',
label=paste0('Mean = ',round(mean_umum,0)),
x = 9,
y = mean_umum + 10,
color='darkred') +
annotate(geom='label',
label=paste0('Median = ',round(median_umum,0)),
x = 13,
y = median_umum + 5,
color='darkgreen') +
labs(title = "Top 30 Kabupaten Kota",
subtitle = "Banyaknya Dokter Spesialis dan Sub Spesialis Gigi per Kabupaten dan Kota",
caption = "Sumber: Kemenkes\nVisualized using R\nikanx101.com") +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.y = element_text(size = 8),
legend.position = "none")
data =
data %>%
select(nama_kab_kota,
provinsi,
dokter_umum,
dokter_spesialis,
dokter_sub_spesialis,
dokter_gigi,
dokter_gigi_spesialis_dan_sub_spesialis) %>%
mutate(dokter_umum = cut(dokter_umum,breaks=6,labels=c(1:6)),
dokter_spesialis = cut(dokter_spesialis,breaks=6,labels=c(1:6)),
dokter_sub_spesialis = cut(dokter_sub_spesialis,breaks=6,labels=c(1:6)),
dokter_gigi = cut(dokter_gigi,breaks=6,labels=c(1:6)),
dokter_gigi_spesialis_dan_sub_spesialis = cut(dokter_gigi_spesialis_dan_sub_spesialis,breaks=6,labels=c(1:6))
)
library(factoextra)
library(cluster)
fviz_nbclust(data, kmeans, method = "wss")
data
data_cluster = data %>% select(-nama_kab_kota,-provinsi)
fviz_nbclust(data_cluster, kmeans, method = "wss")
fviz_nbclust(data_cluster, kmeans, method = "silhouette")
fviz_nbclust(data_cluster, kmeans, method = "wss")
silhouette
fviz_nbclust(data_cluster, kmeans, method = "silhouette")
kmeans(data_cluster, 9, nstart = 25)
fviz_nbclust(data_cluster, kmeans, method = "silhouette")
fviz_nbclust(data_cluster, kmeans, method = "wss")
kmeans(data_cluster, 4, nstart = 25)
fviz_nbclust(data_cluster, kmeans, method = "wss")
gap_stat <- clusGap(data_cluster, FUN = kmeans, nstart = 25,K.max = 10, B = 190)
gap_stat <- clusGap(data_cluster, FUN = kmeans, nstart = 25,K.max = 10, B = 190)
gap_stat <- clusGap(data_cluster, FUN = kmeans, nstart = 25,K.max = 12, B = 190)
gap_stat <- clusGap(data_cluster, FUN = kmeans, nstart = 2,K.max = 12, B = 190)
data_cluster = data %>% select(-nama_kab_kota,-provinsi) %>% mutate_if(is.factor,as.numeric)
fviz_nbclust(data_cluster, kmeans, method = "wss")
fviz_nbclust(data_cluster, kmeans, method = "silhouette")
gap_stat <- clusGap(data_cluster, FUN = kmeans, nstart = 2,K.max = 12, B = 190)
fviz_gap_stat(gap_stat)
kmeans(data_cluster, 8, nstart = 25)
