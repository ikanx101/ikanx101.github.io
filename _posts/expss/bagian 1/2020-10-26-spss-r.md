---
date: 2020-10-26T5:30:00-04:00
title: "TUTORIAL: Alternatif Pengganti SPSS Menggunakan R"
categories:
  - Blog
tags:
  - Machine Learning
  - Artificial Intelligence
  - SPSS
  - R
  - Tabulasi
  - Cross Tabulasi
  - Tutorial
---


<img src="https://raw.githubusercontent.com/ikanx101/ikanx101.github.io/master/_posts/expss/bagian%201/SPSS.jpg" width="827" />

-----

> Siapa sih yang gak kenal dengan **SPSS**? Software yang paling banyak
> digunakan untuk menyelesaikan masalah statistik.

Mulai dari membuat analisa deskriptif yang sederhana sampai membuat
model *machine learning* yang kompleks bisa dilakukan di **SPSS**. Dulu
ketika masih menjadi mahasiswa tingkat akhir, saya pernah menjadi
asisten lab `bio statistik` yang memberikan tutor **SPSS**. Namun
demikian, bagi mahasiswa Matematika sendiri, kami tidak pernah diberikan
materi lab **SPSS** sana sekali.

> **SPSS** membuat kamu malas.

Begitu selentingan yang saya dengar.

Kalau begitu *software* apa yang dipelajari oleh mahasiswa Matematika
untuk menyelesaikan masalah statistik terkait data?

**Microsoft Excel\!**

Saat itu **SPSS** yang digunakan adalah versi `13` *student edition*
resmi.

-----

Kisah **SPSS** saya berlanjut saat saya mulai bekerja di bidang *market
research* pada tahun 2008. Hampir semua orang tim *data processing* di
*market research agency* tempat saya bekerja menggunakan **SPSS**. Waktu
itu mereka menggunakan versi `17`. Usut punya usut ternyata versi yang
digunakan itu bukan berasal dari jalur resmi.

Istilahnya versi *crack*-an yang didapatkan dari forum `berbagi-file`
populer pada zamannya.

Kisah terus berlanjut sampai saya berlabuh di perusahaan tempat saya
bekerja saat ini. Ternyata \_\_@nutrifood\_\_ memiliki *license* resmi
SPSS versi `13` yang digunakan oleh semua *member* tim *market
research*. Namun versi tersebut sudah cukup *usang* untuk melakukan
beberapa analisa dan mengolah data survey yang semakin banyak. Apalagi
semenjak IBM membeli kepemilikan **SPSS**, memakai versi bajakan dari
*software* ini bukanlah pilihan yang bijak.

Setelah mencari informasi terkait harga resminya, ternyata harganya
lumayan juga *yah*.

<img src="https://raw.githubusercontent.com/ikanx101/ikanx101.github.io/master/_posts/expss/bagian%201/Screenshot_20201023-101029.png" height="60%" />

Tipe *license* **SPSS** yang dibutuhkan untuk mengolah data market riset
adalah yang `standard` karena sudah bisa mengakomodir *multiple response
answer*.

-----

## Perbedaan Data Survey dengan Data Lainnya

Apa sih perbedaan antara data survey dengan data lain? (Misalkan data
transaksi atau data *scrape* dari *social media*).

Disadari atau tidak, dalam survey, responden bisa ditanyakan suatu
pertanyaan yang bisa lebih dari satu jawaban. *Market researcher*
menyebutnya dengan istilah *multiple answer question*. Jawaban responden
akan disimpan menjadi *multiple column*.

> Prinsipnya adalah satu responden disimpan dalam satu baris data.

Berbeda dengan data transaksi atau data *social media* yang memungkinkan
dibentuk menjadi **tabular** (satu *response* bisa disimpan *as multiple
columns*).

Maka dari itu, *tools* pengolahan data market riset harus bisa
mengakomodir hal ini.

-----

## Masalah dengan **SPSS**

Seperti yang telah saya sampaikan sebelumnya, faktor harga menjadi salah
satu kendala terbesar bagi (hampir semua) perusahaan untuk bisa
menggunakan **SPSS** secara legal. Banyak di antara perusahaan malah
tetap memilih untuk menggunakan *software* bajakan. Menurut beberapa
sumber, IBM sedang galak-galaknya melakukan sidak ke
perusahaan-perusahaan untuk menangkap perusahaan yang *nakal*.

Setau saya memang ada konsekuensi hukum bagi yang melakukan hal ini.

> Selain itu, memakai *software* bajakan bisa jadi menghilangkan
> **keberkahan** pekerjaan kita lho.

## Alternatif **SPSS**

Kita sebenarnya bisa memakai *software* olah data selain **SPSS** yang
bersifat *open source* alias gratis. Salah satunya dengan **R** melalui
`library(expss)`.

Berikut ini adalah beberapa kelebihan mengolah data survey dengan
`library(expss)`:

1.  Kita tidak perlu repot-repot mengubah tipe data menjadi *numeric
    with labels*. Pada **SPSS**, kita tahu ada dua *tab*, yakni
    *variabel view* dan *data view*. Biasanya salah satu *preparation*
    yang harus dilakukan di **SPSS** adalah mengubah data *text* hasil
    *entry* kuesioner menjadi *numeric* lalu diberikan *value label*.
    Hasil *entry* kuesioner yang sudah berupa *text* bisa langsung kita
    pakai. Biasanya ini terjadi saat kita menggunakan *platform online
    survey* yang memberikan data *as it is*.
2.  Kita bisa melakukan `uji beda dua proporsi` langsung di **R**.
3.  Kita bisa langsung membuat grafik dari hasil tabulasi dengan
    `library(ggplot2)` dan membuat *report*-nya dengan **R Markdown**.
4.  **R** bisa membaca banyak format data. Baik `.sav` **SPSS** dan
    `.csv`, `.xls`, `.xlsx` dari **MS. Excel**.

Bagaimana caranya? Saya mulai tutorialnya *yah*.

-----

## Bahan-Bahan yang Dibutuhkan

Oke, untuk melakukannya kita memerlukan **R** dan atau **R Studio**.
Kemudian kita harus menginstall beberapa *libraries* seperti:

1.  `dplyr` untuk melakukan *data carpentry* di **R**.
2.  `expss` sebagai pengganti **SPSS** di **R**.
3.  `openxlsx` untuk *export* tabulasi ke format `.xlsx`.

Cara installnya adalah:

``` r
# install.packages("dplyr")
# install.packages("expss")
# install.packages("openxlsx")
```

Selepas instalasi selesai, mari kita panggil kedua *libraries* tersebut:

``` r
library(dplyr)
library(expss)
library(openxlsx)
```

Sekarang saya akan menggunakan contoh data hasil survey mengenai
persepsi dan habit responden. Pertanyaan dalam survey tersebut antara
lain:

1.  `kota` asal responden.
2.  `gender`.
3.  `usia`.
4.  `pernah`-kah responden membeli sayur dan daging dalam sebulan
    terakhir?
5.  `tempat` responden pernah membeli sayur dan daging dalam sebulan
    terakhir.
6.  `rating` kesukaan terhadap minuman soda.

Survey dilakukan kepada `1.000` orang responden di 5 kota (Jakarta,
Bandung, Tasikmalaya, Garut, dan Sukabumi). Sebagai latihan bersama,
data bisa diunduh di
[sini](https://raw.githubusercontent.com/ikanx101/ikanx101.github.io/master/_posts/expss/bagian%201/data%20survey.csv).

Berikut adalah datanya:

``` r
data = read.csv("data survey.csv") 
```

<table>

<caption>

20 Data Teratas

</caption>

<thead>

<tr>

<th style="text-align:right;">

id

</th>

<th style="text-align:left;">

kota

</th>

<th style="text-align:left;">

gender

</th>

<th style="text-align:right;">

usia

</th>

<th style="text-align:left;">

pernah

</th>

<th style="text-align:left;">

tempat\_1

</th>

<th style="text-align:left;">

tempat\_2

</th>

<th style="text-align:left;">

tempat\_3

</th>

<th style="text-align:left;">

tempat\_4

</th>

<th style="text-align:left;">

tempat\_5

</th>

<th style="text-align:left;">

rating

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:right;">

1

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

35

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

2

</td>

<td style="text-align:left;">

Jakarta

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

32

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

3

</td>

<td style="text-align:left;">

Jakarta

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

27

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

4

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

39

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

minimarket

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

5

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

30

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat suka

</td>

</tr>

<tr>

<td style="text-align:right;">

6

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

31

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

minimarket

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat suka

</td>

</tr>

<tr>

<td style="text-align:right;">

7

</td>

<td style="text-align:left;">

Tasikmalaya

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

38

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

minimarket

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

8

</td>

<td style="text-align:left;">

Sukabumi

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

30

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

9

</td>

<td style="text-align:left;">

Garut

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

39

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

10

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

26

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat suka

</td>

</tr>

<tr>

<td style="text-align:right;">

11

</td>

<td style="text-align:left;">

Jakarta

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

33

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

12

</td>

<td style="text-align:left;">

Tasikmalaya

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

30

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

minimarket

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

13

</td>

<td style="text-align:left;">

Sukabumi

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

38

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

14

</td>

<td style="text-align:left;">

Tasikmalaya

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

33

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

15

</td>

<td style="text-align:left;">

Garut

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

35

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

minimarket

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

sangat tidak suka

</td>

</tr>

<tr>

<td style="text-align:right;">

16

</td>

<td style="text-align:left;">

Bandung

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

34

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

supermarket

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

17

</td>

<td style="text-align:left;">

Tasikmalaya

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

25

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

18

</td>

<td style="text-align:left;">

Garut

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

34

</td>

<td style="text-align:left;">

tidak

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

19

</td>

<td style="text-align:left;">

Tasikmalaya

</td>

<td style="text-align:left;">

wanita

</td>

<td style="text-align:right;">

27

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

<tr>

<td style="text-align:right;">

20

</td>

<td style="text-align:left;">

Sukabumi

</td>

<td style="text-align:left;">

pria

</td>

<td style="text-align:right;">

34

</td>

<td style="text-align:left;">

ya

</td>

<td style="text-align:left;">

pasar

</td>

<td style="text-align:left;">

warung

</td>

<td style="text-align:left;">

online

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

NA

</td>

<td style="text-align:left;">

suka

</td>

</tr>

</tbody>

</table>

-----

## Prinsip dasar `library(expss)`

Skrip pada `library(expss)` selalu menggunakan *pipe* pada `tidyverse`
(`%>%`).

Berikut adalah alur pengerjaannya:

1.  Tabulasi dimulai dengan memanggil dataset.
2.  Memanggil variabel yang hendak dihitung dengan
    `tab_cells(nama_variabel)`.
3.  Jika hendak melakukan *cross tabulasi*, tambahkan perintah
    `tab_cols(nama_variabel)` sesuai dengan variabel yang hendak
    disilangkan.
4.  Jika hendak melakukan *drill down* pada baris, tambahkan perintah
    `tab_rows(nama_variabel)` sesuai dengan variabel yang hendak
    disilangkan.
5.  Panggil perintah untuk menghitung persentase atau *real number*.
    Untuk persentase, bisa menggunakan perintah `tab_stat_cpct()`. Untuk
    *real number*, bisa menggunakan perintah `tab_stat_cases()`.
6.  Jika hendak melakukan uji beda dua proporsi pada *cross tabulasi*,
    `tambahkan tab_last_sig_cpct()` atau `tab_last_sig_cases()`.
7.  Akhiri dengan `tab_pivot()`.

*Yuk*, kita praktek langsung\!

## Frekuensi Tabulasi

Mari kita mulai dengan menghitung proporsi `kota` dan `gender` dari
survey ini:

``` r
data %>% 
  tab_cells(kota) %>% 
  tab_stat_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 1: Kota Asal Responden")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="2" style="text-align: left;">

Tabel 1: Kota Asal Responden

</td>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; border-top: 2px solid grey; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;">

 \#Total 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="2" style="font-weight: 900;">

 kota 

</td>

</tr>

<tr>

<td style="text-align: left;">

   Bandung 

</td>

<td style="text-align: right;">

19.1

</td>

</tr>

<tr>

<td style="text-align: left;">

   Garut 

</td>

<td style="text-align: right;">

18.6

</td>

</tr>

<tr>

<td style="text-align: left;">

   Jakarta 

</td>

<td style="text-align: right;">

22.4

</td>

</tr>

<tr>

<td style="text-align: left;">

   Sukabumi 

</td>

<td style="text-align: right;">

20.4

</td>

</tr>

<tr>

<td style="text-align: left;">

   Tasikmalaya 

</td>

<td style="text-align: right;">

19.5

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

   \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

1000

</td>

</tr>

</tbody>

</table>

``` r
data %>% 
  tab_cells(gender) %>% 
  tab_stat_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 2: Gender Responden")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="2" style="text-align: left;">

Tabel 2: Gender Responden

</td>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; border-top: 2px solid grey; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;">

 \#Total 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="2" style="font-weight: 900;">

 gender 

</td>

</tr>

<tr>

<td style="text-align: left;">

   pria 

</td>

<td style="text-align: right;">

29.3

</td>

</tr>

<tr>

<td style="text-align: left;">

   wanita 

</td>

<td style="text-align: right;">

70.7

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

   \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

1000

</td>

</tr>

</tbody>

</table>

Sekarang saya akan menghitung proporsi dari rating dengan menggunakan
*real number*:

``` r
data %>% 
  tab_cells(rating) %>% 
  tab_stat_cases() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 3: Rating Kesukaan Responden (real number)")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="2" style="text-align: left;">

Tabel 3: Rating Kesukaan Responden (real number)

</td>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; border-top: 2px solid grey; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;">

 \#Total 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="2" style="font-weight: 900;">

 rating 

</td>

</tr>

<tr>

<td style="text-align: left;">

   sangat tidak suka 

</td>

<td style="text-align: right;">

257

</td>

</tr>

<tr>

<td style="text-align: left;">

   tidak suka 

</td>

<td style="text-align: right;">

108

</td>

</tr>

<tr>

<td style="text-align: left;">

   suka 

</td>

<td style="text-align: right;">

499

</td>

</tr>

<tr>

<td style="text-align: left;">

   sangat suka 

</td>

<td style="text-align: right;">

136

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

   \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

1000

</td>

</tr>

</tbody>

</table>

## *Cross* Tabulasi

Berikutnya saya akan membuat tabel *cross* tabulasi `rating` vs `kota`
sekaligus menghitung signifikansinya:

``` r
data %>% 
  tab_cells(rating) %>% 
  tab_cols(total(),kota) %>% 
  tab_stat_cpct() %>% 
  tab_last_sig_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Table 4. Cross tabulasi Pernah dan Kota")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="12" style="text-align: left;">

Table 4. Cross tabulasi Pernah dan Kota

</td>

</tr>

<tr>

<th style="border-top: 2px solid grey;">

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 \#Total 

</th>

<th style="border-top: 2px solid grey;; border-bottom: hidden;">

 

</th>

<th colspan="9" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 kota 

</th>

</tr>

<tr>

<th style>

</th>

<th colspan="1" style="font-weight: 900; text-align: center;">

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Bandung 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Garut 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Jakarta 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Sukabumi 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Tasikmalaya 

</th>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 A 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 B 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 C 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 D 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 E 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="12" style="font-weight: 900;">

 rating 

</td>

</tr>

<tr>

<td style="text-align: left;">

   sangat tidak suka 

</td>

<td style="text-align: right;">

25.7 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

26.7 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

27.4 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

21.9  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

26.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

26.7 

</td>

</tr>

<tr>

<td style="text-align: left;">

   tidak suka 

</td>

<td style="text-align: right;">

10.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

13.1 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

8.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

11.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

12.3 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

8.2 

</td>

</tr>

<tr>

<td style="text-align: left;">

   suka 

</td>

<td style="text-align: right;">

49.9 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

44.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

51.1 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

55.4 A D

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

45.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

52.8 

</td>

</tr>

<tr>

<td style="text-align: left;">

   sangat suka 

</td>

<td style="text-align: right;">

13.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

16.2 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

12.9 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

11.2  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

15.7 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

12.3 

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

   \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

1000 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

191 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

186 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

224  

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

204 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

195 

</td>

</tr>

</tbody>

</table>

Kita bisa melihat bahwa `suka` di Jakarta **signifikan** lebih tinggi
dibandingkan Bandung dan Sukabumi.

Sekarang saya akan membuat *cross* tabulasi rata-rata usia per kota:

``` r
data %>% 
  tab_cells(usia) %>% 
  tab_cols(total(),kota) %>% 
  tab_stat_mean_sd_n() %>% 
  tab_last_sig_means() %>% 
  tab_pivot() %>% 
  set_caption("Table 5. Rata-rata Usia per Kota")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="12" style="text-align: left;">

Table 5. Rata-rata Usia per Kota

</td>

</tr>

<tr>

<th style="border-top: 2px solid grey;">

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 \#Total 

</th>

<th style="border-top: 2px solid grey;; border-bottom: hidden;">

 

</th>

<th colspan="9" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 kota 

</th>

</tr>

<tr>

<th style>

</th>

<th colspan="1" style="font-weight: 900; text-align: center;">

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Bandung 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Garut 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Jakarta 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Sukabumi 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Tasikmalaya 

</th>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 A 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 B 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 C 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 D 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 E 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="12" style="font-weight: 900;">

 usia 

</td>

</tr>

<tr>

<td style="text-align: left;">

   Mean 

</td>

<td style="text-align: right;">

32.1 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

31.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

31.9 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

31.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

32.5 A

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

32.7 A C

</td>

</tr>

<tr>

<td style="text-align: left;">

   Std. dev. 

</td>

<td style="text-align: right;">

4.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

4.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

4.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

4.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

4.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

4.3  

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

   Unw. valid N 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

1000.0 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

191.0 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

186.0 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

224.0 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

204.0  

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

195.0  

</td>

</tr>

</tbody>

</table>

Ternyata rata-rata usia responden di Tasikmalaya **signifikan** lebih
tua dibandingkan Bandung dan Jakarta. Sedangkan usia responden di
Sukabumi **signifikan** lebih tua dibandingkan Bandung.

## *Multiple Response*

Sekarang kita akan menghitung frekuensi tabulasi untuk pertanyaan
*multiple response*. Pada kasus ini adalah variabel `tempat_1` sampai
`tempat_5`.

``` r
data %>% 
  tab_cells(mrset(tempat_1 %to% tempat_2)) %>% 
  tab_stat_cpct() %>% 
  tab_pivot()%>% 
  set_caption("Table 6. Tempat Berbelanja")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="2" style="text-align: left;">

Table 6. Tempat Berbelanja

</td>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; border-top: 2px solid grey; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;">

 \#Total 

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align: left;">

 minimarket 

</td>

<td style="text-align: right;">

36.3

</td>

</tr>

<tr>

<td style="text-align: left;">

 online 

</td>

<td style="text-align: right;">

45.1

</td>

</tr>

<tr>

<td style="text-align: left;">

 pasar 

</td>

<td style="text-align: right;">

39.7

</td>

</tr>

<tr>

<td style="text-align: left;">

 supermarket 

</td>

<td style="text-align: right;">

37.3

</td>

</tr>

<tr>

<td style="text-align: left;">

 warung 

</td>

<td style="text-align: right;">

37.3

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

 \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

375

</td>

</tr>

</tbody>

</table>

Kita juga bisa membuat *cross* tabulasi untuk pertanyaan *multiple
response* berikut:

``` r
data %>% 
  tab_cells(mrset(tempat_1 %to% tempat_2)) %>% 
  tab_cols(total(),kota) %>% 
  tab_rows(gender) %>% 
  tab_stat_cpct() %>% 
  tab_last_sig_cpct() %>% 
  tab_pivot()%>% 
  set_caption("Table 7. Detail Tempat Berbelanja")
```

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">

<thead>

<tr>

<td colspan="14" style="text-align: left;">

Table 7. Detail Tempat Berbelanja

</td>

</tr>

<tr>

<th style="border-top: 2px solid grey;">

</th>

<th colspan="1" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">

</th>

<th style="border-top: 2px solid grey;; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 \#Total 

</th>

<th style="border-top: 2px solid grey;; border-bottom: hidden;">

 

</th>

<th colspan="9" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">

 kota 

</th>

</tr>

<tr>

<th style>

</th>

<th colspan="1" style="font-weight: 900; text-align: center;">

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; text-align: center;">

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Bandung 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Garut 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Jakarta 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Sukabumi 

</th>

<th style="; border-bottom: hidden;">

 

</th>

<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">

 Tasikmalaya 

</th>

</tr>

<tr>

<th style="border-bottom: 1px solid grey; font-weight: 900; text-align: center;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: left;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: left;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 A 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 B 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 C 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 D 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;" colspan="1">

 

</th>

<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: right;">

 E 

</th>

</tr>

</thead>

<tbody>

<tr>

<td colspan="14" style="font-weight: 900;">

 gender 

</td>

</tr>

<tr>

<td style="text-align: left;">

   pria 

</td>

<td style="text-align: left;">

 minimarket 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

43.6 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

48.0  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

40.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

47.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

42.9  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

38.9 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 online 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

41.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

48.0 B

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

20.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

47.6 B  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

66.7 B E

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

27.8 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 pasar 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

39.1 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

28.0  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

52.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

42.9  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

23.8  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

50.0 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 supermarket 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

41.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

44.0  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

44.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

38.1  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

38.1  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

44.4 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 warung 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

29.1 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

20.0  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

40.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

19.0  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

28.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

38.9 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 \#Total cases 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

110 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

25  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

25 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

21  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

21  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

18 

</td>

</tr>

<tr>

<td style="text-align: left;">

   wanita 

</td>

<td style="text-align: left;">

 minimarket 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

33.2 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

26.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

37.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

33.3  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

31.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

38.0 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 online 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

46.4 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

56.6  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

41.7 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

40.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

47.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

46.0 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 pasar 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

40.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

43.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

47.9 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

36.8  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

40.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

32.0 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 supermarket 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

35.5 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

28.3  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

43.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

28.1  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

35.1  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

44.0 

</td>

</tr>

<tr>

<td style="text-align: left;">

  

</td>

<td style="text-align: left;">

 warung 

</td>

<td style="text-align: left;" colspan="1">

 

</td>

<td style="text-align: right;">

40.8 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

43.4  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

25.0 

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

57.9 B E

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

42.1  

</td>

<td style="text-align: right;" colspan="1">

 

</td>

<td style="text-align: right;">

32.0 

</td>

</tr>

<tr>

<td style="border-bottom: 2px solid grey; text-align: left;">

  

</td>

<td style="border-bottom: 2px solid grey; text-align: left;">

 \#Total cases 

</td>

<td style="border-bottom: 2px solid grey; text-align: left;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

265 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

53  

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

48 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

57  

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

57  

</td>

<td style="border-bottom: 2px solid grey; text-align: right;" colspan="1">

 

</td>

<td style="border-bottom: 2px solid grey; text-align: right;">

50 

</td>

</tr>

</tbody>

</table>

Tentunya masih banyak lagi fitur dan *function* yang bisa dilakukan.
Tapi segitu saja harusnya sudah cukup ya.

-----

## *Exporting to Excel*

Sekarang saya akan tunjukkan cara agar tabel-tabel di atas dimasukkan ke
satu file Excel `.xlsx`.

### Buat dulu *object* tabelnya

``` r
tab1 = 
  data %>% 
  tab_cells(kota) %>% 
  tab_stat_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 1: Kota Asal Responden")

tab2 = 
  data %>% 
  tab_cells(gender) %>% 
  tab_stat_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 2: Gender Responden")

tab3 = 
  data %>% 
  tab_cells(rating) %>% 
  tab_stat_cases() %>% 
  tab_pivot() %>% 
  set_caption("Tabel 3: Rating Kesukaan Responden (real number)")

tab4 = 
  data %>% 
  tab_cells(rating) %>% 
  tab_cols(total(),kota) %>% 
  tab_stat_cpct() %>% 
  tab_last_sig_cpct() %>% 
  tab_pivot() %>% 
  set_caption("Table 4. Cross tabulasi Pernah dan Kota")

tab5 = 
  data %>% 
  tab_cells(usia) %>% 
  tab_cols(total(),kota) %>% 
  tab_stat_mean_sd_n() %>% 
  tab_last_sig_means() %>% 
  tab_pivot() %>% 
  set_caption("Table 5. Rata-rata Usia per Kota")

tab6 = 
  data %>% 
  tab_cells(mrset(tempat_1 %to% tempat_2)) %>% 
  tab_stat_cpct() %>% 
  tab_pivot()%>% 
  set_caption("Table 6. Tempat Berbelanja")

tab7 = 
  data %>% 
  tab_cells(mrset(tempat_1 %to% tempat_2)) %>% 
  tab_cols(total(),kota) %>% 
  tab_rows(gender) %>% 
  tab_stat_cpct() %>% 
  tab_last_sig_cpct() %>% 
  tab_pivot()%>% 
  set_caption("Table 7. Detail Tempat Berbelanja")
```

### Buat *workbook*

``` r
wb = createWorkbook()
```

### Buat *worksheets* lalu *save* ke *Excel*

``` r
tabel = list(tab1,tab2,tab3,tab4,tab5,tab6,tab7)

for(i in 1:7){
  nama_sheet = paste0("tabel",i)
  sh = addWorksheet(wb, nama_sheet)
  xl_write(tabel[[i]], wb, sh)
}

saveWorkbook(wb, "tabulasi.xlsx", overwrite = TRUE)
```

File hasilnya bisa di-*download* di
[sini](https://github.com/ikanx101/ikanx101.github.io/blob/master/_posts/expss/bagian%201/tabulasi.xlsx).
