---
title: "Menghitung Peluang Menggunakan Distribusi Binomial"
format: 
  gfm:
    html-math-method: webtex
    toc: true
    toc-depth: 4
    fig-dpi: 500
    fig-width: 8
    fig-height: 4.5
editor: visual
execute:
  echo: false
  warning: false
  error: false
---

## Pendahuluan

Beberapa minggu yang lalu, saya sempat mengikuti diskusi antara tim *sales* dan tim *digital marketing* dari suatu perusahaan (bukan perusahaan tempat saya bekerja saat ini *yah*). Salah satu bahasan dari diskusi tersebut adalah bagaimana tim *sales* (dengan segala keterbatasannya) bisa membuktikan klaim dari tim *digital marketing*. Lantas apa klaimnya?

Tim *digital marketing* mengklaim:

> Sebanyak 70% pembeli produk mereka di *modern outlet* diakibatkan oleh iklan yang mereka buat.

Oleh karena tim *sales* tidak memiliki sumber daya untuk melakukan *market research*, mereka hanya mampu mengerahkan *sales promotion girl* untuk melakukan survey singkat di beberapa *modern outlet* di suatu *time window* tertentu.

Menggunakan prinsip *rule of five*:

> *The rule of five is a rule of thumb in statistics that estimates the median of a population by choosing a random sample of five from that population. It states that there is a 93.75% chance that the median value of a population is between the smallest and largest values in any random sample of five. This rule can be used to save data collection time in order to make a quicker business decision.*

Tim *sales* melakukan survey singkat dari sepuluh *modern outlet*. Tim SPG akan mewawancarai lima orang pembeli pertama yang ada untuk kemudian ditanyakan "apakah mereka membeli karena iklan digital?". Akhirnya didapatkan data sebanyak `50 orang` responden yang didapatkan dari sepuluh buah *modern outlet* (**lima responden** per *modern outlet*).

```{r}
#| include: false

library(dplyr)
library(tidyr)
library(ggplot2)
library(parallel)
library(janitor)
library(epoxy)

rm(list=ls())

prop_pop = .5

# fungsi bikin survey
bikin_data = function(n_sample){
  sample(c(0,1),
         n_sample,
         prob = c((1 - prop_pop),
                  prop_pop),
         replace = T)
}

# fungsi rapi-rapi
ubah_data_frame = function(tes){
  tes |> 
  tabyl() |>
  filter(tes == 1) |>
  select(n,percent) |>
  mutate(percent = percent * 100)
}

# kita buat hasil surveynya
n_resp = rep(5,10)
survey = mclapply(n_resp,bikin_data,mc.cores = detectCores())

# kita ubah bentuknya
hasil = mclapply(survey,
                 ubah_data_frame,
                 mc.cores = detectCores())

hasil_survey = 
  do.call(rbind,hasil) |>
  mutate(modern_outlet = paste0("Outlet ke-",
                                1:10)
         )

hasil_survey
mean(hasil_survey$percent)
```

Berikut adalah data yang didapatkan tim *sales*:

```{r}
#| fig-align: center
#| fig-dpi: 350

hasil_survey |>
  mutate(modern_outlet = factor(modern_outlet,
                                levels = paste0("Outlet ke-",
                                                1:10))) |>
  ggplot(aes(x = modern_outlet,
             y = percent)) +
  geom_col(color = "black",
           fill  = "steelblue") +
  geom_label(aes(label = paste0(percent,"%")),size = 2) +
  coord_flip() +
  ggthemes::theme_economist_white() +
  labs(title = "Hasil Survey Tim Sales",
       subtitle = "Base: Lima responden per outlet",
       y = "Persentase responden yang membeli produk karena\niklan digital marketing") +
  theme(axis.title.y = element_blank())
```

> Rata-rata persentasenya adalah `r mean(hasil_survey$percent)`%.

## Pertanyaannya

Bagaimana menentukan benar/tidaknya klaim tim *digital marketing* dari data seadanya *tim sales*?

------------------------------------------------------------------------

## Penyelesaian

Mendapatkan *business question* seperti itu membuat saya berpikir bagaimana penyelesaiannya. Sempat saya berpikir untuk menggunakan prinsip simulasi Monte Carlo seperti [tulisan saya terkait COVID dulu](https://ikanx101.com/blog/rapid-pabrik/). Namun kali ini saya akan mencoba menyelesaikannya dengan cara yang lebih eksak.

## Distribusi Binomial

Pikiran saya terbang jauh saat saya sedang kuliah **analisa data** saat S1 dulu ke materi **distribusi binomial**. Distribusi binomial adalah distribusi peluang dari variabel diskrit yang biasa digunakan untuk menyelesaikan masalah-masalah yang bisa dikategorikan sebagai `success` atau `not success`.

Secara matematis, peluang bisa dihitung dari formula berikut:

$$P(x) = \begin{pmatrix}
n\\ 
x
\end{pmatrix} p^x (1-p)^{n-x}$$

Dimana:

$\begin{pmatrix} n\\ x \end{pmatrix}$ merupakan kombinasi terjadinya *event* $x$ dari $n$ total kejadian.

$p$ menandakan proporsi *success* pada populasi.


```{r}
dbinom(1, size = 5, prob = 3 / 10) 
help(dbinom)
```
