---
title: "Product Portofolio Management: Produk Mana Saja yang Harus Diberi Promo? Sebuah Cerita Optimasi di R"
output: 
  github_document:
    pandoc_args: --webtex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("/cloud/project/_posts/linear problem/post 2")
library(dplyr)
library(tictoc)
library(lpSolve)
```

## Prolog

Sudah beberapa bulan ini, saya dan beberapa teman-teman alumni Matematika sedang membentuk komunitas bersama dengan para mahasiswa Matematika ITB tingkat 2 dan 3. Tujuan kami alumni adalah untuk _grooming_ para mahasiswa agar `siap pakai` setelah lulus dalam bidang _data science_.

Dari kami alumni sendiri, bidang pekerjaannya cukup beragam. Ada yang dari FMCG, _retail_, _telco_, _banking_, sampai _start up market place_.

Salah satu keuntungan bagi saya dalam _sharing_ dan `mengajar` di komunitas ini adalah saya _gak_ harus menjelaskan secara detail kepada mereka. Kenapa?

> Mereka kan mahasiswa matematika. Justru secara _skill_ bisa jadi mereka lebih jago daripada saya dan teman-teman alumni lainnya.

Kami tinggal memoles di bagian _softskill_ dan membuka wawasan terhadap algoritma-algoritma dan teknik yang biasa dipakai di berbagai bidang industri.

---

## _Competition_

Beberapa waktu yang lalu, salah satu senior saya yang sekarang bekerja di salah satu _marketplace_ memberikan satu _dataset_ untuk dikompetisikan.

Kali ini kompetisinya bukan tentang _prediction_ atau _classification_! Justru harus diselesaikan dengan teknik yang kita sudah pelajari sejak SMA. Apa itu? [_Linear Programming_](https://ikanx101.com/blog/linear-r/).

Saya sudah menuliskan tentang aplikasi _linear programming_ di [tulisan sebelumnya](https://ikanx101.com/blog/linear-r/). Tapi kali ini teknik yang digunakan sedikit berbeda.

---

## _Problem Statement_

Ceritanya, senior saya memiliki data xx produk yang dijual di _marketplace_-nya. Produk-produk tersebut adalah produk yang memiliki [_price elasticity_](https://ikanx101.com/blog/blog-posting-regresi/) yang tinggi. 

Jadi, saat ada diskon potongan harga di produk tersebut, _sales qty_-nya akan meningkat.

> Semakin bagus jualan produk tersebut tentunya juga akan menambah profit dari _marketplace_ tersebut!

Diskon potongan harga bisa diberikan oleh si _seller_ atau dari pihak _marketplace_. Bisa saja dua-duanya (baik _seller_ dan _marketplace_) memberikan diskon terhadap produk tersebut.

> Coba deh diingat saat kita berbelanja di _marketplace_, apa kita pernah mendapatkan diskon potongan harga _double_? Potongan dari seller dan `kupon` yang diberikan _marketplace_.

Dia diberikan _budget_ sebesar `Rp 200.000.000` untuk melakukan promo. Kini dia harus memilih sebanyak-banyaknya produk yang bisa digelontorkan promo diskon. Tujuannya simpel: _gain the highest profit_ dari produk-produk pilihan tersebut.

Kompetisi: Produk apa saja yang harus dipilih?

## _Dataset_

Berikut adalah cuplikan _dataset_ yang digunakan:

```{r}
# knitrr:kable(head(data,10),caption = "10 Data Teratas")
```

Ada tiga variabel yang digunakan, yakni:

1. `product_code`, yakni kode product yang listed di marketplace. Sebenarnya nama _brand_ dan deskripsi produk ada. Tapi saya _hide_ saja _yah_ __v(n_n)__.
1. `cost`, yakni biaya yang harus dikeluarkan untuk memberikan potongan diskon kepada pelanggan. Ini adalah variabel yang harus diperhatikan, karena apapun produk yang dipilih nanti, $\sum(cost_i) \leq Rp200jt$.
1. `expected_profit`, yakni profit yang diproyeksikan akan didapatkan _marketplace_ saat produk diberikan diskon. _Nah_, untuk menghitung berapa besar `expected_profit` per produk ada caranya tersendiri. Kelak, perhitungan ini akan dijadikan kompetisi tahap kedua.

---

# Solusi

Sebagaimana yang telah saya sampaikan di tulisan sebelumnya, kini saya akan selesaikan permasalahan ini dengan dua cara:

1. Simulasi Monte Carlo, dan
1. _Binary Linear Programming_.

Tapi sebelum saya masuk ke cara penyelesaian, saya akan lakukan pemilihan dataset terlebih dahulu.

Total ada xx baris data TAPI tidak semua data akan saya gunakan. Saya hanya akan menggunakan produk-produk yang memiliki `expected_profit` $> Rp 0$.

```{r}
# filter data
```

Ternyata, setelah saya _filter_ dari xx baris, saya hanya akan menggunakan xx baris. Tidak sampai

## Simulasi Monte Carlo