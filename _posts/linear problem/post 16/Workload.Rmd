---
title: "Optimization Story: Menyeimbangkan Workload untuk Team Members"
output: 
  github_document:
    pandoc_args: --webtex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rm(list=ls())

library(dplyr)
library(ompr)
library(ompr.roi)
library(ROI.plugin.glpk)
library(tidyr)

load("soal.rda")
```

Suatu hari, saya dihubungi oleh seorang rekan yang kerjanya nun jauh di sana. Saya diminta menyelesaikan masalah yang dia hadapi sehari-hari sebagai _leader_ di tempatnya bekerja.

Permasalahan ini adalah tipikal permasalahan rutin yang selalu dihadapi olehnya secara mingguan. Oleh karena dilakukan secara manual, lama-lama prosesnya jadi mengganggu pekerjaannya yang lain. 

Apa masalahnya? _Cekidot_.

# Masalah

Dalam suatu _workcenter_, terdapat 4 orang pekerja yang bekerja selama 4 hari kerja dalam seminggu. Jam kerja per harinya adalah selama 7 jam saja. Dalam seminggu, ada banyak _request_ pekerjaan yang masuk ke dalam _workcenter_ tersebut.

Contoh _request_-nya sebagai berikut:

```{r,echo=FALSE,warning=FALSE,message=FALSE}
df_req |> knitr::kable()
```


Bagaimana caranya menyusun jadwal yang baik untuk masing-masing _team member_?

Tentunya masalah ini termasuk ke dalam masalah optimisasi karena ada tujuan untuk membuat jadwal yang terbaik. Artinya ada hal yang hendak di-minimumkan atau di-maksimumkan.

---

Tentunya sebelum kita mencoba membuat model dan menyelesaikan masalah ini, kita perlu tahu terlebih dahulu apa saja aturan kerja yang ada di _workcenter_ rekan saya tersebut.

Berikut adalah beberapa aturan kerja yang berhasil saya korek:

1. Setiap _request_ yang muncul hanya boleh dikerjakan oleh satu orang _team member_ saja.
1. _Team member_ diperbolehkan lembur maksimum 2 jam perhari. Namun hanya diperbolehkan seminggu maksimum 2 kali lembur.
1. Pekerjaan harus diselesaikan pada hari itu (tidak boleh terputus atau ganti hari).
1. Pekerjaan yang memakan waktu $\geq$ 4 jam sebisa mungkin disebar merata (tidak boleh hanya dikerjakan oleh orang yang itu-itu saja).

---

Bagaimana membangun modelnya? Mari kita mulai.

_Oh iya_, berhubung rekan saya tidak memerlukan jadwal detail per jam, maka saya akan buat model yang simpel (_output_-nya tetap bisa menunjukkan siapa mengerjakan apa di hari ke berapa).

## _Decision Variable_

Saya definisikan indeks sebagai berikut:

- $i = 1,..,4$ sebagai pekerja.
- $j = 1,..,4$ sebagai hari.
- $k = 1,..,30$ sebagai _request_.

Misalkan $x_{ijk}$ _binary_:

- $x_{ijk} = 1$, jika pekerja $i$ pada hari $j$ mengerjakan $k$.
- $x_{ijk} = 0$, lainnya.

## Parameter

Dari informasi yang ada, parameter yang terlibat:

- $T = 7$ merupakan jam kerja maksimum.
- $T_{max} = 9$ merupakan jam kerja lembur yang diperbolehkan 2 kali seminggu.
- $t_k$ merupakan waktu kerja kegiatan $k$.

## _Constraints_

Kita akan turunkan formula untuk _constraints_ dari aturan kerja yang ada.

__Pertama__ Setiap _request_ yang muncul hanya boleh dikerjakan oleh satu orang _team member_ saja.

$$\forall k \sum_{ij} x_{ijk} = 1$$


1. _Team member_ diperbolehkan lembur maksimum 2 jam perhari. Namun hanya diperbolehkan seminggu maksimum 2 kali lembur.
1. Pekerjaan harus diselesaikan pada hari itu (tidak boleh terputus atau ganti hari).
1. Pekerjaan yang memakan waktu $\geq$ 4 jam sebisa mungkin disebar merata (tidak boleh hanya dikerjakan oleh orang yang itu-itu saja).


## _Objective Function_

Meminimumkan jam kerja _team member_.

$$\min \sum{x_{ijk} \times t_k}$$















